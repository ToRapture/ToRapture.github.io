<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/uploads/favicon32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/uploads/favicon16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"torapture.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Some notes">
<meta property="og:type" content="website">
<meta property="og:title" content="ToRapture&#39;s Blog">
<meta property="og:url" content="https://torapture.github.io/page/3/index.html">
<meta property="og:site_name" content="ToRapture&#39;s Blog">
<meta property="og:description" content="Some notes">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="ToRapture">
<meta property="article:tag" content="ToRapture, Linux">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://torapture.github.io/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>ToRapture's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ToRapture's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">A Programmer</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/05/09/Endianness/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/09/Endianness/" class="post-title-link" itemprop="url">Endianness</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-05-09 16:46:00 16:46:00" itemprop="dateCreated datePublished" datetime="2020-05-09T16:46:00+08:00">2020-05-09 16:46:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/05/09/Endianness/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/05/09/Endianness/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="what-is-endianness">What is endianness?</h1>
<p>Little and big endian are two ways of storing multibyte data-types ( int, float, etc). In little endian machines, last byte of binary representation of the multibyte data-type is stored first. On the other hand, in big endian machines, first byte of binary representation of the multibyte data-type is stored first.</p>
<h1 id="how-to-check">How to check</h1>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DBG(x) cerr &lt;&lt; #x &lt;&lt; <span class="meta-string">&quot; = &quot;</span> &lt;&lt; x &lt;&lt; endl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">get_endian</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">union</span> &#123;</span><br><span class="line">        <span class="keyword">short</span> s;</span><br><span class="line">        <span class="keyword">char</span> c[<span class="keyword">sizeof</span>(<span class="keyword">short</span>)];</span><br><span class="line">    &#125; un;</span><br><span class="line">    un.s = <span class="number">0x1020</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">sizeof</span>(<span class="keyword">short</span>) != <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;sizeof(short) != 2&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (un.c[<span class="number">0</span>] == <span class="number">0x20</span> &amp;&amp; un.c[<span class="number">1</span>] == <span class="number">0x10</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;little-endian&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (un.c[<span class="number">0</span>] == <span class="number">0x10</span> &amp;&amp; un.c[<span class="number">1</span>] == <span class="number">0x20</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;big-endian&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;unknown&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;endian: &quot;</span> &lt;&lt; get_endian() &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="network-byte-order">Network byte order</h1>
<p>https://stackoverflow.com/a/997586/13133551</p>
<blockquote>
<p>"Network byte order" is Big Endian, and protocols such as TCP use this for integer fields (e.g. port numbers). Functions such as htons and ntohs can be used to do conversion.</p>
</blockquote>
<blockquote>
<p>The data itself doesn't have any endianness it's entirely application defined.</p>
</blockquote>
<p><img src="/images/posts/Endianness/0.png" /> As we can see from the picture, the endianness of net is Big Endian.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/05/09/tcpdump-learn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/09/tcpdump-learn/" class="post-title-link" itemprop="url">tcpdump learn</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-05-09 15:00:00 15:00:00" itemprop="dateCreated datePublished" datetime="2020-05-09T15:00:00+08:00">2020-05-09 15:00:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/05/09/tcpdump-learn/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/05/09/tcpdump-learn/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="docs-and-articles">Docs and Articles</h1>
<p><a target="_blank" rel="noopener" href="https://www.tcpdump.org/manpages/tcpdump.1.html">Manpage of TCPDUMP</a></p>
<p><a target="_blank" rel="noopener" href="https://www.tcpdump.org/manpages/pcap-filter.7.html">Manpage of PCAP-FILTER</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.netgate.com/pfsense/en/latest/book/packetcapture/using-tcpdump-from-the-command-line.html">Examples of using tcpdump on the command line</a></p>
<p><a target="_blank" rel="noopener" href="http://github.tiankonguse.com/blog/2016/08/13/tcpdump.html">tcpdump命令详解</a></p>
<h1 id="capture-of-tcp">Capture of tcp</h1>
<p><img src="/images/posts/tcpdump-learn/0.png" /></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/05/03/Learning-of-DNS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/03/Learning-of-DNS/" class="post-title-link" itemprop="url">Learning of DNS</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-05-03 13:37:00 13:37:00" itemprop="dateCreated datePublished" datetime="2020-05-03T13:37:00+08:00">2020-05-03 13:37:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/05/03/Learning-of-DNS/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/05/03/Learning-of-DNS/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="headers">Headers</h1>
<p><img src="/images/posts/Learning-of-DNS/0.png" /></p>
<h2 id="lables">Lables</h2>
<p>Each label can be up to 63 characters long, and an entire FQDN(fully qualified domain name) is limited to at most 255 (1-byte) characters.</p>
<p><img src="/images/posts/Learning-of-DNS/1.png" /> <img src="/images/posts/Learning-of-DNS/2.png" /></p>
<h2 id="query-format">Query Format</h2>
<p><img src="/images/posts/Learning-of-DNS/3.png" /></p>
<h2 id="answer-format">Answer Format</h2>
<p><img src="/images/posts/Learning-of-DNS/4.png" /></p>
<h1 id="commands-and-packets">Commands and Packets</h1>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ dig baidu.com</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; baidu.com</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 22302</span><br><span class="line">;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1</span><br><span class="line"></span><br><span class="line">;; OPT PSEUDOSECTION:</span><br><span class="line">; EDNS: version: 0, flags:; udp: 65494</span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;baidu.com.			IN	A</span><br><span class="line"></span><br><span class="line">;; ANSWER SECTION:</span><br><span class="line">baidu.com.		5	IN	A	39.156.69.79</span><br><span class="line">baidu.com.		5	IN	A	220.181.38.148</span><br><span class="line"></span><br><span class="line">;; Query time: 3 msec</span><br><span class="line">;; SERVER: 127.0.0.53#53(127.0.0.53)</span><br><span class="line">;; WHEN: 日 5月 03 13:16:51 CST 2020</span><br><span class="line">;; MSG SIZE  rcvd: 70</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/images/posts/Learning-of-DNS/5.png" /> <img src="/images/posts/Learning-of-DNS/6.png" /></p>
<h1 id="simulation">Simulation</h1>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">$ dig +trace baidu.com</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; +trace baidu.com</span><br><span class="line">;; global options: +cmd</span><br><span class="line">.			5	IN	NS	l.root-servers.net.</span><br><span class="line">.			5	IN	NS	g.root-servers.net.</span><br><span class="line">.			5	IN	NS	b.root-servers.net.</span><br><span class="line">.			5	IN	NS	d.root-servers.net.</span><br><span class="line">.			5	IN	NS	j.root-servers.net.</span><br><span class="line">.			5	IN	NS	c.root-servers.net.</span><br><span class="line">.			5	IN	NS	a.root-servers.net.</span><br><span class="line">.			5	IN	NS	e.root-servers.net.</span><br><span class="line">.			5	IN	NS	m.root-servers.net.</span><br><span class="line">.			5	IN	NS	f.root-servers.net.</span><br><span class="line">.			5	IN	NS	i.root-servers.net.</span><br><span class="line">.			5	IN	NS	k.root-servers.net.</span><br><span class="line">.			5	IN	NS	h.root-servers.net.</span><br><span class="line">;; Received 262 bytes from 127.0.0.53#53(127.0.0.53) in 4 ms</span><br><span class="line"></span><br><span class="line">com.			172800	IN	NS	l.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	b.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	c.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	d.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	e.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	f.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	g.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	a.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	h.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	i.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	j.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	k.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	m.gtld-servers.net.</span><br><span class="line">com.			86400	IN	DS	30909 8 2 E2D3C916F6DEEAC73294E8268FB5885044A833FC5459588F4A9184CF C41A5766</span><br><span class="line">com.			86400	IN	RRSIG	DS 8 1 86400 20200515170000 20200502160000 48903 . ypoqNHa&#x2F;RJ1a9uTlm4QyNZ9V&#x2F;&#x2F;oHsA2EnziYqGpmhTGWfZm1VbAriN&#x2F;R cKPWdyq03XcdJl8chkHjyYFc2O7iLNiqJVTc2zUBKyBCcSY4nqftN4J+ Xhpn8i2PZaK89YoJ0u3ptUuoNQO7r7qqFoQA38TjZmVjb0xtpRsc3Qe8 NFzkHkpGG0lE87BUcxob2xxwG&#x2F;w2THCu7067TbF9s5pm1NcOIgLpLrPN qAN9gal6OWpPcoj78SLrp+WG66yJLEQ1UgZafO3JaUTTUF78HCC08GL&#x2F; YfuQQSNVAJdkdYmhdSMNEPHF3YVYu2C6RWveng0HJeDfY487jKpgsmp7 0qfo8w&#x3D;&#x3D;</span><br><span class="line">;; Received 1169 bytes from 192.5.5.241#53(f.root-servers.net) in 312 ms</span><br><span class="line"></span><br><span class="line">baidu.com.		172800	IN	NS	ns2.baidu.com.</span><br><span class="line">baidu.com.		172800	IN	NS	ns3.baidu.com.</span><br><span class="line">baidu.com.		172800	IN	NS	ns4.baidu.com.</span><br><span class="line">baidu.com.		172800	IN	NS	ns1.baidu.com.</span><br><span class="line">baidu.com.		172800	IN	NS	ns7.baidu.com.</span><br><span class="line">CK0POJMG874LJREF7EFN8430QVIT8BSM.com. 86400 IN NSEC3 1 1 0 - CK0Q1GIN43N1ARRC9OSM6QPQR81H5M9A NS SOA RRSIG DNSKEY NSEC3PARAM</span><br><span class="line">CK0POJMG874LJREF7EFN8430QVIT8BSM.com. 86400 IN RRSIG NSEC3 8 2 86400 20200509044919 20200502033919 39844 com. TuW7Gtye26JizEnQgFR2wx0iaSNeV0B+H+NGxpMvErXVC8UgY0qikZYw Q2edAoLCg1NUX+eQe6XJxCg6fxZXgmjY53nFrvS96DVAmlzHXIMGRZz9 XLb6r1dM5a9FmjWj7&#x2F;Ad8CLFU4tKaARAP1eL7XAuFDIxOquFBlr2ezsz ekU8XCfOPXoFDVBREFxTbUmR09Dca+ZHK5aQmb+22qzr6A&#x3D;&#x3D;</span><br><span class="line">HPVUNU64MJQUM37BM3VJ6O2UBJCHOS00.com. 86400 IN NSEC3 1 1 0 - HPVVN3Q5E5GOQP2QFE2LEM4SVB9C0SJ6 NS DS RRSIG</span><br><span class="line">HPVUNU64MJQUM37BM3VJ6O2UBJCHOS00.com. 86400 IN RRSIG NSEC3 8 2 86400 20200508042230 20200501031230 39844 com. O1F4LRXLKjRCSFcKBKFZRjVdZ7qGVDs2J3TcPWoiCg3XEfghP2I6lA8e SGhCEbmSuLlKh7bnhLuASVnN69&#x2F;y+gVUtNa16eK2rNBtIrbBorwm32Dz KzMlZHdK5g5JI73IZtMaSz&#x2F;oUKdqxpCgsilK0P7guLT5e9+q2pO2ROGg XrA4o3fThVbDWzRXvyXKFX1zCyBaHs+18ko17GGb8qTWDw&#x3D;&#x3D;</span><br><span class="line">;; Received 757 bytes from 192.42.93.30#53(g.gtld-servers.net) in 104 ms</span><br><span class="line"></span><br><span class="line">baidu.com.		600	IN	A	220.181.38.148</span><br><span class="line">baidu.com.		600	IN	A	39.156.69.79</span><br><span class="line">baidu.com.		86400	IN	NS	ns4.baidu.com.</span><br><span class="line">baidu.com.		86400	IN	NS	dns.baidu.com.</span><br><span class="line">baidu.com.		86400	IN	NS	ns7.baidu.com.</span><br><span class="line">baidu.com.		86400	IN	NS	ns3.baidu.com.</span><br><span class="line">baidu.com.		86400	IN	NS	ns2.baidu.com.</span><br><span class="line">;; Received 240 bytes from 220.181.33.31#53(ns2.baidu.com) in 12 ms</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line">$ dig</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt;</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 18754</span><br><span class="line">;; flags: qr rd ra; QUERY: 1, ANSWER: 13, AUTHORITY: 0, ADDITIONAL: 1</span><br><span class="line"></span><br><span class="line">;; OPT PSEUDOSECTION:</span><br><span class="line">; EDNS: version: 0, flags:; udp: 65494</span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;.				IN	NS</span><br><span class="line"></span><br><span class="line">;; ANSWER SECTION:</span><br><span class="line">.			5	IN	NS	l.root-servers.net.</span><br><span class="line">.			5	IN	NS	g.root-servers.net.</span><br><span class="line">.			5	IN	NS	b.root-servers.net.</span><br><span class="line">.			5	IN	NS	d.root-servers.net.</span><br><span class="line">.			5	IN	NS	j.root-servers.net.</span><br><span class="line">.			5	IN	NS	c.root-servers.net.</span><br><span class="line">.			5	IN	NS	a.root-servers.net.</span><br><span class="line">.			5	IN	NS	e.root-servers.net.</span><br><span class="line">.			5	IN	NS	m.root-servers.net.</span><br><span class="line">.			5	IN	NS	f.root-servers.net.</span><br><span class="line">.			5	IN	NS	i.root-servers.net.</span><br><span class="line">.			5	IN	NS	k.root-servers.net.</span><br><span class="line">.			5	IN	NS	h.root-servers.net.</span><br><span class="line"></span><br><span class="line">;; Query time: 4 msec</span><br><span class="line">;; SERVER: 127.0.0.53#53(127.0.0.53)</span><br><span class="line">;; WHEN: 日 5月 03 13:28:35 CST 2020</span><br><span class="line">;; MSG SIZE  rcvd: 239</span><br><span class="line"></span><br><span class="line">$ dig @l.root-servers.net. baidu.com</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; @l.root-servers.net. baidu.com</span><br><span class="line">; (2 servers found)</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 4979</span><br><span class="line">;; flags: qr rd; QUERY: 1, ANSWER: 0, AUTHORITY: 13, ADDITIONAL: 27</span><br><span class="line">;; WARNING: recursion requested but not available</span><br><span class="line"></span><br><span class="line">;; OPT PSEUDOSECTION:</span><br><span class="line">; EDNS: version: 0, flags:; udp: 4096</span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;baidu.com.			IN	A</span><br><span class="line"></span><br><span class="line">;; AUTHORITY SECTION:</span><br><span class="line">com.			172800	IN	NS	a.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	b.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	c.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	d.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	e.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	f.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	g.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	h.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	i.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	j.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	k.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	l.gtld-servers.net.</span><br><span class="line">com.			172800	IN	NS	m.gtld-servers.net.</span><br><span class="line"></span><br><span class="line">;; ADDITIONAL SECTION:</span><br><span class="line">a.gtld-servers.net.	172800	IN	A	192.5.6.30</span><br><span class="line">b.gtld-servers.net.	172800	IN	A	192.33.14.30</span><br><span class="line">c.gtld-servers.net.	172800	IN	A	192.26.92.30</span><br><span class="line">d.gtld-servers.net.	172800	IN	A	192.31.80.30</span><br><span class="line">e.gtld-servers.net.	172800	IN	A	192.12.94.30</span><br><span class="line">f.gtld-servers.net.	172800	IN	A	192.35.51.30</span><br><span class="line">g.gtld-servers.net.	172800	IN	A	192.42.93.30</span><br><span class="line">h.gtld-servers.net.	172800	IN	A	192.54.112.30</span><br><span class="line">i.gtld-servers.net.	172800	IN	A	192.43.172.30</span><br><span class="line">j.gtld-servers.net.	172800	IN	A	192.48.79.30</span><br><span class="line">k.gtld-servers.net.	172800	IN	A	192.52.178.30</span><br><span class="line">l.gtld-servers.net.	172800	IN	A	192.41.162.30</span><br><span class="line">m.gtld-servers.net.	172800	IN	A	192.55.83.30</span><br><span class="line">a.gtld-servers.net.	172800	IN	AAAA	2001:503:a83e::2:30</span><br><span class="line">b.gtld-servers.net.	172800	IN	AAAA	2001:503:231d::2:30</span><br><span class="line">c.gtld-servers.net.	172800	IN	AAAA	2001:503:83eb::30</span><br><span class="line">d.gtld-servers.net.	172800	IN	AAAA	2001:500:856e::30</span><br><span class="line">e.gtld-servers.net.	172800	IN	AAAA	2001:502:1ca1::30</span><br><span class="line">f.gtld-servers.net.	172800	IN	AAAA	2001:503:d414::30</span><br><span class="line">g.gtld-servers.net.	172800	IN	AAAA	2001:503:eea3::30</span><br><span class="line">h.gtld-servers.net.	172800	IN	AAAA	2001:502:8cc::30</span><br><span class="line">i.gtld-servers.net.	172800	IN	AAAA	2001:503:39c1::30</span><br><span class="line">j.gtld-servers.net.	172800	IN	AAAA	2001:502:7094::30</span><br><span class="line">k.gtld-servers.net.	172800	IN	AAAA	2001:503:d2d::30</span><br><span class="line">l.gtld-servers.net.	172800	IN	AAAA	2001:500:d937::30</span><br><span class="line">m.gtld-servers.net.	172800	IN	AAAA	2001:501:b1f9::30</span><br><span class="line"></span><br><span class="line">;; Query time: 8 msec</span><br><span class="line">;; SERVER: 199.7.83.42#53(199.7.83.42)</span><br><span class="line">;; WHEN: 日 5月 03 13:28:42 CST 2020</span><br><span class="line">;; MSG SIZE  rcvd: 834</span><br><span class="line"></span><br><span class="line">$ dig @a.gtld-servers.net. baidu.com</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; @a.gtld-servers.net. baidu.com</span><br><span class="line">; (2 servers found)</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 59027</span><br><span class="line">;; flags: qr rd; QUERY: 1, ANSWER: 0, AUTHORITY: 5, ADDITIONAL: 6</span><br><span class="line">;; WARNING: recursion requested but not available</span><br><span class="line"></span><br><span class="line">;; OPT PSEUDOSECTION:</span><br><span class="line">; EDNS: version: 0, flags:; udp: 4096</span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;baidu.com.			IN	A</span><br><span class="line"></span><br><span class="line">;; AUTHORITY SECTION:</span><br><span class="line">baidu.com.		172800	IN	NS	ns2.baidu.com.</span><br><span class="line">baidu.com.		172800	IN	NS	ns3.baidu.com.</span><br><span class="line">baidu.com.		172800	IN	NS	ns4.baidu.com.</span><br><span class="line">baidu.com.		172800	IN	NS	ns1.baidu.com.</span><br><span class="line">baidu.com.		172800	IN	NS	ns7.baidu.com.</span><br><span class="line"></span><br><span class="line">;; ADDITIONAL SECTION:</span><br><span class="line">ns2.baidu.com.		172800	IN	A	220.181.33.31</span><br><span class="line">ns3.baidu.com.		172800	IN	A	112.80.248.64</span><br><span class="line">ns4.baidu.com.		172800	IN	A	14.215.178.80</span><br><span class="line">ns1.baidu.com.		172800	IN	A	202.108.22.220</span><br><span class="line">ns7.baidu.com.		172800	IN	A	180.76.76.92</span><br><span class="line"></span><br><span class="line">;; Query time: 292 msec</span><br><span class="line">;; SERVER: 192.5.6.30#53(192.5.6.30)</span><br><span class="line">;; WHEN: 日 5月 03 13:28:48 CST 2020</span><br><span class="line">;; MSG SIZE  rcvd: 208</span><br><span class="line"></span><br><span class="line">$ dig @ns2.baidu.com. baidu.com</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; @ns2.baidu.com. baidu.com</span><br><span class="line">; (1 server found)</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 2415</span><br><span class="line">;; flags: qr aa rd; QUERY: 1, ANSWER: 2, AUTHORITY: 5, ADDITIONAL: 6</span><br><span class="line">;; WARNING: recursion requested but not available</span><br><span class="line"></span><br><span class="line">;; OPT PSEUDOSECTION:</span><br><span class="line">; EDNS: version: 0, flags:; udp: 4096</span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;baidu.com.			IN	A</span><br><span class="line"></span><br><span class="line">;; ANSWER SECTION:</span><br><span class="line">baidu.com.		600	IN	A	39.156.69.79</span><br><span class="line">baidu.com.		600	IN	A	220.181.38.148</span><br><span class="line"></span><br><span class="line">;; AUTHORITY SECTION:</span><br><span class="line">baidu.com.		86400	IN	NS	ns7.baidu.com.</span><br><span class="line">baidu.com.		86400	IN	NS	ns2.baidu.com.</span><br><span class="line">baidu.com.		86400	IN	NS	dns.baidu.com.</span><br><span class="line">baidu.com.		86400	IN	NS	ns3.baidu.com.</span><br><span class="line">baidu.com.		86400	IN	NS	ns4.baidu.com.</span><br><span class="line"></span><br><span class="line">;; ADDITIONAL SECTION:</span><br><span class="line">dns.baidu.com.		86400	IN	A	202.108.22.220</span><br><span class="line">ns2.baidu.com.		86400	IN	A	220.181.33.31</span><br><span class="line">ns3.baidu.com.		86400	IN	A	112.80.248.64</span><br><span class="line">ns4.baidu.com.		86400	IN	A	14.215.178.80</span><br><span class="line">ns7.baidu.com.		86400	IN	A	180.76.76.92</span><br><span class="line"></span><br><span class="line">;; Query time: 8 msec</span><br><span class="line">;; SERVER: 220.181.33.31#53(220.181.33.31)</span><br><span class="line">;; WHEN: 日 5月 03 13:28:54 CST 2020</span><br><span class="line">;; MSG SIZE  rcvd: 240</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>We can see the response of <code>$ dig @ns2.baidu.com. baidu.com</code> have <code>aa</code> flag set.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/28/UDP-and-netstat/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/28/UDP-and-netstat/" class="post-title-link" itemprop="url">UDP and netstat</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-28 12:49:00 12:49:00" itemprop="dateCreated datePublished" datetime="2020-04-28T12:49:00+08:00">2020-04-28 12:49:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/28/UDP-and-netstat/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/28/UDP-and-netstat/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Do some experiment about UDP by Python3 and netstat.</p>
<h2 id="code">Code</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># coding: utf-8</span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">from IPython import embed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    sock &#x3D; socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br><span class="line">    embed()</span><br><span class="line">    sock.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="a-and-b-start">A and B start</h3>
<p>A: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ python3 client.py</span><br><span class="line">Python 3.5.2 (default, Oct  8 2019, 13:06:37)</span><br><span class="line">Type &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line"></span><br><span class="line">IPython 2.4.1 -- An enhanced Interactive Python.</span><br><span class="line">?         -&gt; Introduction and overview of IPython&#39;s features.</span><br><span class="line">%quickref -&gt; Quick reference.</span><br><span class="line">help      -&gt; Python&#39;s own help system.</span><br><span class="line">object?   -&gt; Details about &#39;object&#39;, use &#39;object??&#39; for extra details.</span><br><span class="line"></span><br><span class="line">In [1]:</span><br></pre></td></tr></table></figure></p>
<p>B: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ python3 client.py</span><br><span class="line">Python 3.5.2 (default, Oct  8 2019, 13:06:37)</span><br><span class="line">Type &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line"></span><br><span class="line">IPython 2.4.1 -- An enhanced Interactive Python.</span><br><span class="line">?         -&gt; Introduction and overview of IPython&#39;s features.</span><br><span class="line">%quickref -&gt; Quick reference.</span><br><span class="line">help      -&gt; Python&#39;s own help system.</span><br><span class="line">object?   -&gt; Details about &#39;object&#39;, use &#39;object??&#39; for extra details.</span><br><span class="line"></span><br><span class="line">In [1]:</span><br></pre></td></tr></table></figure> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ netstat -au</span><br><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State</span><br></pre></td></tr></table></figure></p>
<h3 id="a-bind">A bind</h3>
<p>A: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [1]: sock.bind((&#39;localhost&#39;, 10001))</span><br></pre></td></tr></table></figure> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ netstat -au</span><br><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State</span><br><span class="line">udp        0      0 localhost:10001         *:*</span><br></pre></td></tr></table></figure></p>
<h3 id="b-send-to-a">B send to A</h3>
<p>B: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [1]: sock.sendto(b&#39;hello world&#39;, (&#39;localhost&#39;, 10001))</span><br><span class="line">Out[1]: 11</span><br></pre></td></tr></table></figure></p>
<p>A: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [2]: sock.recvfrom(1024)</span><br><span class="line">Out[2]: (b&#39;hello world&#39;, (&#39;127.0.0.1&#39;, 42616))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ netstat -au</span><br><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State</span><br><span class="line">udp      768      0 localhost:10001         *:*</span><br><span class="line">udp        0      0 *:42616                 *:*</span><br></pre></td></tr></table></figure>
<h3 id="a-send-to-b">A send to B</h3>
<p>A: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [3]: sock.sendto(b&#39;This is a response.&#39;, (&#39;127.0.0.1&#39;, 42616))</span><br><span class="line">Out[3]: 19</span><br></pre></td></tr></table></figure></p>
<p>B: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [2]: sock.recvfrom(1024)</span><br><span class="line">Out[2]: (b&#39;This is a response.&#39;, (&#39;127.0.0.1&#39;, 10001))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ netstat -au</span><br><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State</span><br><span class="line">udp        0      0 localhost:10001         *:*</span><br><span class="line">udp        0      0 *:42616                 *:*</span><br></pre></td></tr></table></figure>
<h3 id="b-connect-to-a">B connect to A</h3>
<p>B: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In [4]: sock.connect((&#39;127.0.0.1&#39;, 10001))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ netstat -au</span><br><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State</span><br><span class="line">udp        0      0 localhost:10001         *:*</span><br><span class="line">udp        0      0 localhost:42616         localhost:10001         ESTABLISHED</span><br></pre></td></tr></table></figure>
<p>A: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [4]: sock.sendto(b&#39;This is another response.&#39;, (&#39;127.0.0.1&#39;, 42616))</span><br><span class="line">Out[4]: 25</span><br></pre></td></tr></table></figure></p>
<p>B: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [5]: sock.recvfrom(1024)</span><br><span class="line">Out[5]: (b&#39;This is another response.&#39;, (&#39;127.0.0.1&#39;, 10001))</span><br></pre></td></tr></table></figure></p>
<p>C: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [1]: sock.bind((&#39;127.0.0.1&#39;, 10010))</span><br><span class="line"></span><br><span class="line">In [2]: sock.sendto(b&#39;This is a response from C.&#39;, (&#39;127.0.0.1&#39;, 42616))</span><br><span class="line">Out[2]: 26</span><br></pre></td></tr></table></figure></p>
<p>B: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In [7]: sock.recvfrom(1024)</span><br><span class="line">blocked</span><br></pre></td></tr></table></figure> After B connected to A, B will not receive packets from any endpoint other than A.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/27/UDP-learn-by-Python3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/27/UDP-learn-by-Python3/" class="post-title-link" itemprop="url">UDP learn by Python3</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-27 18:30:00 18:30:00" itemprop="dateCreated datePublished" datetime="2020-04-27T18:30:00+08:00">2020-04-27 18:30:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/27/UDP-learn-by-Python3/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/27/UDP-learn-by-Python3/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="find-max-packet-size">Find max packet size</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_max_udp_packet_size</span>():</span></span><br><span class="line">    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br><span class="line">    max_sz = <span class="number">0</span></span><br><span class="line">    l, r = <span class="number">0</span>, <span class="number">65535</span> - <span class="number">8</span> - <span class="number">20</span></span><br><span class="line">    <span class="keyword">while</span> l &lt;= r:</span><br><span class="line">        mid = int((l + r) / <span class="number">2</span>)</span><br><span class="line">        ok = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            sock.sendto(<span class="string">b&#x27;A&#x27;</span> * mid, (<span class="string">&#x27;localhost&#x27;</span>, <span class="number">9</span>))</span><br><span class="line">        <span class="keyword">except</span> socket.error:</span><br><span class="line">            ok = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ok:</span><br><span class="line">            max_sz = mid</span><br><span class="line">            l = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r = mid - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> max_sz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    max_sz = find_max_udp_packet_size()</span><br><span class="line">    print(<span class="string">&#x27;max_sz = %s&#x27;</span> % max_sz)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>I used the code above to find the max size of a UDP packet size by default configuration. The result on my computer is: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ uname -v</span><br><span class="line">Darwin Kernel Version 19.2.0: Sat Nov  9 03:47:04 PST 2019; root:xnu-6153.61.1~20&#x2F;RELEASE_X86_64</span><br><span class="line">$ python3 --version</span><br><span class="line">Python 3.6.4</span><br><span class="line">$ python3 udp_packet_size.py</span><br><span class="line">max_sz &#x3D; 9216</span><br></pre></td></tr></table></figure></p>
<h2 id="more-test">More test</h2>
<p>Use the code below to test. <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># coding: utf-8</span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">from IPython import embed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    sock &#x3D; socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br><span class="line">    embed()</span><br><span class="line">    sock.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">In [1]: sock.bind((&#39;localhost&#39;, 10001))</span><br><span class="line"></span><br><span class="line">In [2]: receiver &#x3D; (&#39;localhost&#39;, 10002)</span><br><span class="line"></span><br><span class="line">In [3]: sock.sendto(b&#39;01234567&#39;, receiver)</span><br><span class="line">Out[3]: 8</span><br><span class="line"></span><br><span class="line">In [4]: sock.sendto(b&#39;01234567&#39;, receiver)</span><br><span class="line">Out[4]: 8</span><br><span class="line"></span><br><span class="line">In [5]: sock.sendto(b&#39;01234567&#39;, receiver)</span><br><span class="line">Out[5]: 8</span><br><span class="line"></span><br><span class="line">In [6]: sock.sendto(b&#39;01234567&#39;, receiver)</span><br><span class="line">Out[6]: 8</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">In [1]: sock.bind((&#39;localhost&#39;, 10002))</span><br><span class="line"></span><br><span class="line">In [2]: receiver &#x3D; (&#39;localhost&#39;, 10001)</span><br><span class="line"></span><br><span class="line">In [3]: print(sock.recvfrom(1024))</span><br><span class="line">(b&#39;01234567&#39;, (&#39;127.0.0.1&#39;, 10001))</span><br><span class="line"></span><br><span class="line">In [4]: print(sock.recvfrom(4))</span><br><span class="line">(b&#39;0123&#39;, (&#39;127.0.0.1&#39;, 10001))</span><br><span class="line"></span><br><span class="line">In [5]: print(sock.recvfrom(4))</span><br><span class="line">(b&#39;0123&#39;, (&#39;127.0.0.1&#39;, 10001))</span><br><span class="line"></span><br><span class="line">In [6]: print(sock.recvfrom(4))</span><br><span class="line">(b&#39;0123&#39;, (&#39;127.0.0.1&#39;, 10001))</span><br><span class="line"></span><br><span class="line">In [7]: print(sock.recvfrom(4))</span><br></pre></td></tr></table></figure>
<p>We can see that if the <code>bufsize</code> is smaller the length of the packet received, will only read <code>bufsize</code> bytes of the received data, and the rest of that packet will not be returned in subsequent reads.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/27/UDP-headers-and-checksum/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/27/UDP-headers-and-checksum/" class="post-title-link" itemprop="url">UDP headers and checksum</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-27 14:03:00 14:03:00" itemprop="dateCreated datePublished" datetime="2020-04-27T14:03:00+08:00">2020-04-27 14:03:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/27/UDP-headers-and-checksum/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/27/UDP-headers-and-checksum/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="udp-headers">UDP headers</h2>
<p><img src="/images/posts/UDP-headers-and-checksum/0.png" /></p>
<h2 id="headers-for-computing-checksum">Headers for computing checksum</h2>
<p><img src="/images/posts/UDP-headers-and-checksum/1.png" /></p>
<p>The checksum computation is similar to the Internet checksum computation.</p>
<p><img src="/images/posts/UDP-headers-and-checksum/2.png" /></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DBG(x) cerr &lt;&lt; #x &lt;&lt; <span class="meta-string">&quot; = &quot;</span> &lt;&lt; x &lt;&lt; endl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="title">checksum</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">unsigned</span> <span class="keyword">short</span>&gt; &amp;v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; v.size(); i++) &#123;</span><br><span class="line">        sum += v[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (sum &gt; <span class="number">0xFFFF</span>) &#123;</span><br><span class="line">        sum = (sum &amp; <span class="number">0xFFFF</span>) + (sum &gt;&gt; <span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ~sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">unsigned</span> <span class="keyword">short</span>&gt; vec&#123;</span><br><span class="line">            <span class="comment">// UDP pseudo-header</span></span><br><span class="line">            <span class="number">0x0a01</span>, <span class="number">0xbf44</span>, <span class="comment">// source IP address</span></span><br><span class="line">            <span class="number">0x0a02</span>, <span class="number">0x0002</span>, <span class="comment">// destination IP address</span></span><br><span class="line">            <span class="number">0x0011</span> <span class="comment">/* 1 byte zero and 1 byte protocol number */</span>, <span class="number">0x0023</span>, <span class="comment">// UDP length</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// UDP header</span></span><br><span class="line">            <span class="number">0xc183</span>, <span class="number">0x0035</span>, <span class="comment">// source port number and destination port number</span></span><br><span class="line">            <span class="number">0x0000</span>, <span class="number">0x0023</span>, <span class="comment">// checksum and UDP length</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// data</span></span><br><span class="line">            <span class="number">0x06b0</span>, <span class="number">0x0100</span>,</span><br><span class="line">            <span class="number">0x0001</span>, <span class="number">0x0000</span>,</span><br><span class="line">            <span class="number">0x0000</span>, <span class="number">0x0000</span>,</span><br><span class="line">            <span class="number">0x0562</span>, <span class="number">0x6169</span>,</span><br><span class="line">            <span class="number">0x6475</span>, <span class="number">0x0363</span>,</span><br><span class="line">            <span class="number">0x6f6d</span>, <span class="number">0x0000</span>,</span><br><span class="line">            <span class="number">0x0100</span>, <span class="number">0x0100</span>, <span class="comment">// the length of this UDP packet is odd and the last short is 0x01, so we should pad 1 byte zero.</span></span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">short</span> sum = checksum(vec);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;checksum = 0x%X\n&quot;</span>, sum);</span><br><span class="line">    assert(sum == <span class="number">0x22E4</span>);</span><br><span class="line"></span><br><span class="line">    vec[<span class="number">8</span>] = sum;</span><br><span class="line"></span><br><span class="line">    sum = checksum(vec);</span><br><span class="line">    assert(sum == <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;0x%X\n&quot;</span>, sum);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/26/routetrace/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/26/routetrace/" class="post-title-link" itemprop="url">routetrace</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-26 20:03:00 20:03:00" itemprop="dateCreated datePublished" datetime="2020-04-26T20:03:00+08:00">2020-04-26 20:03:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/26/routetrace/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/26/routetrace/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="command">Command</h2>
<p>https://linux.die.net/man/8/traceroute</p>
<blockquote>
<p>This program attempts to trace the route an IP packet would follow to some internet host by launching probe packets with a small ttl (time to live) then listening for an ICMP "time exceeded" reply from a gateway. We start our probes with a ttl of one and increase by one until we get an ICMP "port unreachable" (or TCP reset), which means we got to the "host", or hit a max (which defaults to 30 hops). Three probes (by default) are sent at each ttl setting and a line is printed showing the ttl, address of the gateway and round trip time of each probe. The address can be followed by additional information when requested. If the probe answers come from different gateways, the address of each responding system will be printed. If there is no response within a 5.0 seconds (default), an "*" (asterisk) is printed for that probe.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ traceroute iqiyi.com</span><br><span class="line">traceroute to iqiyi.com (111.206.13.64), 30 hops max, 60 byte packets</span><br><span class="line"> 1  * * *</span><br><span class="line"> 2  11.220.36.9 (11.220.36.9)  6.906 ms 11.220.37.73 (11.220.37.73)  5.219 ms 11.220.36.9 (11.220.36.9)  7.193 ms</span><br><span class="line"> 3  * * *</span><br><span class="line"> 4  10.54.136.253 (10.54.136.253)  0.419 ms 11.217.38.218 (11.217.38.218)  0.366 ms 10.54.137.5 (10.54.137.5)  7.548 ms</span><br><span class="line"> 5  119.38.215.78 (119.38.215.78)  1.215 ms 42.120.253.1 (42.120.253.1)  1.148 ms 117.49.35.198 (117.49.35.198)  1.040 ms</span><br><span class="line"> 6  116.251.113.145 (116.251.113.145)  1.798 ms 42.120.239.249 (42.120.239.249)  2.112 ms 116.251.113.149 (116.251.113.149)  2.287 ms</span><br><span class="line"> 7  157.255.237.149 (157.255.237.149)  5.927 ms  5.809 ms  5.758 ms</span><br><span class="line"> 8  120.80.99.17 (120.80.99.17)  5.375 ms 120.80.98.177 (120.80.98.177)  4.409 ms 120.80.98.181 (120.80.98.181)  6.039 ms</span><br><span class="line"> 9  221.4.0.181 (221.4.0.181)  9.088 ms  8.350 ms  8.086 ms</span><br><span class="line">10  219.158.7.21 (219.158.7.21)  35.774 ms  35.622 ms 219.158.7.17 (219.158.7.17)  39.304 ms</span><br><span class="line">11  124.65.194.34 (124.65.194.34)  41.728 ms 202.96.12.26 (202.96.12.26)  40.799 ms 125.33.186.50 (125.33.186.50)  38.370 ms</span><br><span class="line">12  202.106.34.98 (202.106.34.98)  72.417 ms  67.925 ms  66.970 ms</span><br><span class="line">13  bt-211-070.bta.net.cn (202.106.211.70)  39.312 ms * *</span><br><span class="line">14  111.206.13.64 (111.206.13.64)  39.598 ms  36.527 ms  39.293 ms</span><br></pre></td></tr></table></figure>
<h2 id="simulate-by-ping">Simulate by ping</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">$ ping -c2 -W 1.5 -t 1 iqiyi.com</span><br><span class="line">PING iqiyi.com (111.206.13.64) 56(84) bytes of data.</span><br><span class="line"></span><br><span class="line">--- iqiyi.com ping statistics ---</span><br><span class="line">2 packets transmitted, 0 received, 100% packet loss, time 1007ms</span><br><span class="line"></span><br><span class="line">$ ping -c2 -W 1.5 -t 2 iqiyi.com</span><br><span class="line">PING iqiyi.com (111.206.13.63) 56(84) bytes of data.</span><br><span class="line">From 11.220.36.73 icmp_seq&#x3D;1 Time to live exceeded</span><br><span class="line">From 11.220.36.73 icmp_seq&#x3D;2 Time to live exceeded</span><br><span class="line"></span><br><span class="line">--- iqiyi.com ping statistics ---</span><br><span class="line">2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 1001ms</span><br><span class="line"></span><br><span class="line">$ ping -c2 -W 1.5 -t 3 iqiyi.com</span><br><span class="line">PING iqiyi.com (111.206.13.61) 56(84) bytes of data.</span><br><span class="line">From 11.220.37.130 icmp_seq&#x3D;1 Time to live exceeded</span><br><span class="line">From 11.220.37.130 icmp_seq&#x3D;2 Time to live exceeded</span><br><span class="line"></span><br><span class="line">--- iqiyi.com ping statistics ---</span><br><span class="line">2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 1001ms</span><br><span class="line"></span><br><span class="line">$ ping -c2 -W 1.5 -t 4 iqiyi.com</span><br><span class="line">PING iqiyi.com (111.206.13.64) 56(84) bytes of data.</span><br><span class="line">From 10.54.140.5 icmp_seq&#x3D;1 Time to live exceeded</span><br><span class="line">From 10.54.140.5 icmp_seq&#x3D;2 Time to live exceeded</span><br><span class="line"></span><br><span class="line">--- iqiyi.com ping statistics ---</span><br><span class="line">2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 1001ms</span><br><span class="line"></span><br><span class="line">$ ping -c2 -W 1.5 -t 5 iqiyi.com</span><br><span class="line">PING iqiyi.com (111.206.13.63) 56(84) bytes of data.</span><br><span class="line">From 117.49.35.62 icmp_seq&#x3D;1 Time to live exceeded</span><br><span class="line">From 117.49.35.62 icmp_seq&#x3D;2 Time to live exceeded</span><br><span class="line"></span><br><span class="line">--- iqiyi.com ping statistics ---</span><br><span class="line">2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 1001ms</span><br><span class="line"></span><br><span class="line">$ ping -c2 -W 1.5 -t 6 iqiyi.com</span><br><span class="line">PING iqiyi.com (111.206.13.65) 56(84) bytes of data.</span><br><span class="line">From 42.120.242.229 icmp_seq&#x3D;1 Time to live exceeded</span><br><span class="line">From 42.120.242.229 icmp_seq&#x3D;2 Time to live exceeded</span><br><span class="line"></span><br><span class="line">--- iqiyi.com ping statistics ---</span><br><span class="line">2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 1000ms</span><br><span class="line"></span><br><span class="line">--------</span><br><span class="line"></span><br><span class="line">$ ping -c2 -W 1.5 -t 12 iqiyi.com</span><br><span class="line">PING iqiyi.com (111.206.13.66) 56(84) bytes of data.</span><br><span class="line">From 123.126.0.46 icmp_seq&#x3D;1 Time to live exceeded</span><br><span class="line">From 123.126.0.46 icmp_seq&#x3D;2 Time to live exceeded</span><br><span class="line"></span><br><span class="line">--- iqiyi.com ping statistics ---</span><br><span class="line">2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 1001ms</span><br><span class="line"></span><br><span class="line">$ ping -c2 -W 1.5 -t 13 iqiyi.com</span><br><span class="line">PING iqiyi.com (111.206.13.62) 56(84) bytes of data.</span><br><span class="line">From bt-211-042.bta.net.cn (202.106.211.42) icmp_seq&#x3D;1 Time to live exceeded</span><br><span class="line">From bt-211-042.bta.net.cn (202.106.211.42) icmp_seq&#x3D;2 Time to live exceeded</span><br><span class="line"></span><br><span class="line">--- iqiyi.com ping statistics ---</span><br><span class="line">2 packets transmitted, 0 received, +2 errors, 100% packet loss, time 1001ms</span><br><span class="line"></span><br><span class="line">$ ping -c2 -W 1.5 -t 14 iqiyi.com</span><br><span class="line">PING iqiyi.com (111.206.13.61) 56(84) bytes of data.</span><br><span class="line">64 bytes from 111.206.13.61: icmp_seq&#x3D;1 ttl&#x3D;52 time&#x3D;36.7 ms</span><br><span class="line">64 bytes from 111.206.13.61: icmp_seq&#x3D;2 ttl&#x3D;52 time&#x3D;36.7 ms</span><br><span class="line"></span><br><span class="line">--- iqiyi.com ping statistics ---</span><br><span class="line">2 packets transmitted, 2 received, 0% packet loss, time 1000ms</span><br><span class="line">rtt min&#x2F;avg&#x2F;max&#x2F;mdev &#x3D; 36.726&#x2F;36.737&#x2F;36.748&#x2F;0.011 ms</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/24/IPv4-headers/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/24/IPv4-headers/" class="post-title-link" itemprop="url">IPv4 headers</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-24 17:13:00 17:13:00" itemprop="dateCreated datePublished" datetime="2020-04-24T17:13:00+08:00">2020-04-24 17:13:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/24/IPv4-headers/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/24/IPv4-headers/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>From: TCP/IP Illustrated, Volume 1: The Protocols.</p>
<p><img src="/images/posts/IPv4-headers/0.png" /></p>
<h3 id="ihl">IHL</h3>
<p>The Internet Header Length (IHL) field is the number of 32-bit words in the IPv4 header, including any options. Because this is also a 4-bit field, the IPv4 header is limited to a maximum of fifteen 32-bit words or 60 bytes. ### Total Length The Total Length field is the total length of the IPv4 datagram in bytes. ### Protocol The Protocol field in the IPv4 header contains a number indicating the type of data found in the payload portion of the datagram. The most common values are 17 (for UDP) and 6 (for TCP).</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/24/Commands-for-IP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/24/Commands-for-IP/" class="post-title-link" itemprop="url">Commands for IP</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-24 16:47:00 16:47:00" itemprop="dateCreated datePublished" datetime="2020-04-24T16:47:00+08:00">2020-04-24 16:47:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/24/Commands-for-IP/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/24/Commands-for-IP/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="ifconfig">ifconfig</h2>
<p>https://linux.die.net/man/8/ifconfig</p>
<blockquote>
<p>Ifconfig is used to configure the kernel-resident network interfaces. It is used at boot time to set up interfaces as necessary. After that, it is usually only needed when debugging or when system tuning is needed.</p>
</blockquote>
<p>If no arguments are given, ifconfig displays the status of the currently active interfaces. If a single interface argument is given, it displays the status of the given interface only; if a single -a argument is given, it displays the status of all interfaces, even those that are down. Otherwise, it configures an interface.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ ifconfig</span><br><span class="line">eth0      Link encap:Ethernet  HWaddr 00:16:3e:10:27:9e</span><br><span class="line">          inet addr:172.16.62.130  Bcast:172.16.63.255  Mask:255.255.192.0</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</span><br><span class="line">          RX packets:10188512 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:10123903 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000</span><br><span class="line">          RX bytes:1554718007 (1.5 GB)  TX bytes:15002653955 (15.0 GB)</span><br><span class="line"></span><br><span class="line">lo        Link encap:Local Loopback</span><br><span class="line">          inet addr:127.0.0.1  Mask:255.0.0.0</span><br><span class="line">          UP LOOPBACK RUNNING  MTU:65536  Metric:1</span><br><span class="line">          RX packets:5561316 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:5561316 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1</span><br><span class="line">          RX bytes:720550645 (720.5 MB)  TX bytes:720550645 (720.5 MB)</span><br><span class="line"></span><br><span class="line">$ ifconfig &lt;interface&gt; up</span><br><span class="line">$ ifconfig &lt;interface&gt; down</span><br></pre></td></tr></table></figure>
<hr />
<h2 id="route">route</h2>
<p>https://linux.die.net/man/8/route</p>
<blockquote>
<p>Route manipulates the kernel's IP routing tables. Its primary use is to set up static routes to specific hosts or networks via an interface after it has been configured with the ifconfig(8) program.</p>
</blockquote>
<p>When the add or del options are used, route modifies the routing tables. Without these options, route displays the current contents of the routing tables.</p>
<hr />
<p>https://superuser.com/a/580674</p>
<blockquote>
<p>The Gateway column identifies the defined gateway for the specified network. An asterisk (*) appears in this column if no forwarding gateway is needed for the network.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$ route</span><br><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br><span class="line">default         172.16.63.253   0.0.0.0         UG    0      0        0 eth0</span><br><span class="line">172.16.0.0      *               255.255.192.0   U     0      0        0 eth0</span><br><span class="line"></span><br><span class="line">$ host baidu.com</span><br><span class="line">baidu.com has address 220.181.38.148</span><br><span class="line">baidu.com has address 39.156.69.79</span><br><span class="line">baidu.com mail is handled by 15 mx.n.shifen.com.</span><br><span class="line">baidu.com mail is handled by 20 mx50.baidu.com.</span><br><span class="line">baidu.com mail is handled by 10 mx.maillb.baidu.com.</span><br><span class="line">baidu.com mail is handled by 20 jpmx.baidu.com.</span><br><span class="line">baidu.com mail is handled by 20 mx1.baidu.com.</span><br><span class="line"></span><br><span class="line">$ ip route get 220.181.38.148</span><br><span class="line">220.181.38.148 via 172.16.63.253 dev eth0  src 172.16.62.130</span><br><span class="line">    cache</span><br><span class="line"></span><br><span class="line">$ ping -c1 220.181.38.148</span><br><span class="line">PING 220.181.38.148 (220.181.38.148) 56(84) bytes of data.</span><br><span class="line">64 bytes from 220.181.38.148: icmp_seq&#x3D;1 ttl&#x3D;49 time&#x3D;36.6 ms</span><br><span class="line"></span><br><span class="line">--- 220.181.38.148 ping statistics ---</span><br><span class="line">1 packets transmitted, 1 received, 0% packet loss, time 0ms</span><br><span class="line">rtt min&#x2F;avg&#x2F;max&#x2F;mdev &#x3D; 36.620&#x2F;36.620&#x2F;36.620&#x2F;0.000 ms</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$ sudo route add 220.181.38.148 eth0</span><br><span class="line"></span><br><span class="line">$ route</span><br><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br><span class="line">default         172.16.63.253   0.0.0.0         UG    0      0        0 eth0</span><br><span class="line">172.16.0.0      *               255.255.192.0   U     0      0        0 eth0</span><br><span class="line">220.181.38.148  *               255.255.255.255 UH    0      0        0 eth0</span><br><span class="line"></span><br><span class="line">$ ip route get 220.181.38.148</span><br><span class="line">220.181.38.148 dev eth0  src 172.16.62.130</span><br><span class="line">    cache</span><br><span class="line"></span><br><span class="line">$ ping -c1 220.181.38.148</span><br><span class="line">PING 220.181.38.148 (220.181.38.148) 56(84) bytes of data.</span><br><span class="line">From 172.16.62.130 icmp_seq&#x3D;1 Destination Host Unreachable</span><br><span class="line"></span><br><span class="line">--- 220.181.38.148 ping statistics ---</span><br><span class="line">1 packets transmitted, 0 received, +1 errors, 100% packet loss, time 0ms</span><br><span class="line"></span><br><span class="line">$ sudo route del 220.181.38.148</span><br><span class="line"></span><br><span class="line">$ route</span><br><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br><span class="line">default         172.16.63.253   0.0.0.0         UG    0      0        0 eth0</span><br><span class="line">172.16.0.0      *               255.255.192.0   U     0      0        0 eth0</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">$ sudo route add 220.181.38.148 gw 172.16.63.253</span><br><span class="line"></span><br><span class="line">$ route</span><br><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br><span class="line">default         172.16.63.253   0.0.0.0         UG    0      0        0 eth0</span><br><span class="line">172.16.0.0      *               255.255.192.0   U     0      0        0 eth0</span><br><span class="line">220.181.38.148  172.16.63.253   255.255.255.255 UGH   0      0        0 eth0</span><br><span class="line"></span><br><span class="line">$ ip route get 220.181.38.148</span><br><span class="line">220.181.38.148 via 172.16.63.253 dev eth0  src 172.16.62.130</span><br><span class="line">    cache</span><br><span class="line"></span><br><span class="line">$ ping -c1 220.181.38.148</span><br><span class="line">PING 220.181.38.148 (220.181.38.148) 56(84) bytes of data.</span><br><span class="line">64 bytes from 220.181.38.148: icmp_seq&#x3D;1 ttl&#x3D;49 time&#x3D;36.5 ms</span><br><span class="line"></span><br><span class="line">--- 220.181.38.148 ping statistics ---</span><br><span class="line">1 packets transmitted, 1 received, 0% packet loss, time 0ms</span><br><span class="line">rtt min&#x2F;avg&#x2F;max&#x2F;mdev &#x3D; 36.538&#x2F;36.538&#x2F;36.538&#x2F;0.000 ms</span><br><span class="line"></span><br><span class="line">$ sudo route del 220.181.38.148</span><br><span class="line"></span><br><span class="line">$ route</span><br><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br><span class="line">default         172.16.63.253   0.0.0.0         UG    0      0        0 eth0</span><br><span class="line">172.16.0.0      *               255.255.192.0   U     0      0        0 eth0</span><br></pre></td></tr></table></figure>
<hr />
<h2 id="iptables">iptables</h2>
<p>https://linux.die.net/man/8/iptables</p>
<blockquote>
<p>iptables - administration tool for IPv4 packet filtering and NAT</p>
</blockquote>
<h3 id="default">default</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">root@nenuoj$ iptables -L -v --line-numbers</span><br><span class="line">Chain INPUT (policy ACCEPT 290 packets, 18937 bytes)</span><br><span class="line">num   pkts bytes target     prot opt in     out     source               destination</span><br><span class="line"></span><br><span class="line">Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)</span><br><span class="line">num   pkts bytes target     prot opt in     out     source               destination</span><br><span class="line"></span><br><span class="line">Chain OUTPUT (policy ACCEPT 202 packets, 41678 bytes)</span><br><span class="line">num   pkts bytes target     prot opt in     out     source               destination</span><br><span class="line"></span><br><span class="line">torapture@rapture$ ping -c4 D.D.D.D</span><br><span class="line">PING D.D.D.D (D.D.D.D) 56(84) bytes of data.</span><br><span class="line">64 bytes from D.D.D.D: icmp_seq&#x3D;1 ttl&#x3D;45 time&#x3D;192 ms</span><br><span class="line">64 bytes from D.D.D.D: icmp_seq&#x3D;2 ttl&#x3D;45 time&#x3D;180 ms</span><br><span class="line">64 bytes from D.D.D.D: icmp_seq&#x3D;3 ttl&#x3D;45 time&#x3D;194 ms</span><br><span class="line">64 bytes from D.D.D.D: icmp_seq&#x3D;4 ttl&#x3D;45 time&#x3D;180 ms</span><br><span class="line"></span><br><span class="line">--- D.D.D.D ping statistics ---</span><br><span class="line">4 packets transmitted, 4 received, 0% packet loss, time 2998ms</span><br><span class="line">rtt min&#x2F;avg&#x2F;max&#x2F;mdev &#x3D; 180.029&#x2F;186.853&#x2F;194.475&#x2F;6.724 ms</span><br></pre></td></tr></table></figure>
<h3 id="drop">drop</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@nenuoj$ iptables -A INPUT -s S.S.S.S -j DROP</span><br><span class="line"></span><br><span class="line">torapture@rapture$ ping -c4 D.D.D.D</span><br><span class="line">PING D.D.D.D (D.D.D.D) 56(84) bytes of data.</span><br><span class="line"></span><br><span class="line">--- D.D.D.D ping statistics ---</span><br><span class="line">4 packets transmitted, 0 received, 100% packet loss, time 3024ms</span><br><span class="line"></span><br><span class="line">root@nenuoj$ iptables -L -v --line-numbers</span><br><span class="line">Chain INPUT (policy ACCEPT 54 packets, 3339 bytes)</span><br><span class="line">num   pkts bytes target     prot opt in     out     source               destination</span><br><span class="line">1        4   336 DROP       all  --  any    any     S.S.S.S       anywhere</span><br><span class="line"></span><br><span class="line">Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)</span><br><span class="line">num   pkts bytes target     prot opt in     out     source               destination</span><br><span class="line"></span><br><span class="line">Chain OUTPUT (policy ACCEPT 44 packets, 13276 bytes)</span><br><span class="line">num   pkts bytes target     prot opt in     out     source               destination</span><br></pre></td></tr></table></figure>
<h3 id="reject-tcp80">reject tcp:80</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@nenuoj$ iptables -A INPUT -s S.S.S.S -p tcp --destination-port 80 -j REJECT</span><br><span class="line"></span><br><span class="line">torapture@rapture$ curl D.D.D.D</span><br><span class="line">curl: (7) Failed to connect to D.D.D.D port 80: Connection refused</span><br><span class="line"></span><br><span class="line">root@nenuoj$ iptables -L -v --line-numbers</span><br><span class="line">Chain INPUT (policy ACCEPT 91 packets, 5449 bytes)</span><br><span class="line">num   pkts bytes target     prot opt in     out     source               destination</span><br><span class="line">1        1    60 REJECT     tcp  --  any    any     S.S.S.S       anywhere             tcp dpt:http reject-with icmp-port-unreachable</span><br><span class="line"></span><br><span class="line">Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)</span><br><span class="line">num   pkts bytes target     prot opt in     out     source               destination</span><br><span class="line"></span><br><span class="line">Chain OUTPUT (policy ACCEPT 70 packets, 14548 bytes)</span><br><span class="line">num   pkts bytes target     prot opt in     out     source               destination</span><br></pre></td></tr></table></figure>
<hr />
<h2 id="ip">ip</h2>
<p>https://linux.die.net/man/8/ip</p>
<blockquote>
<p>ip - show / manipulate routing, devices, policy routing and tunnels</p>
</blockquote>
<h3 id="address">address</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@nenuoj$ ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1</span><br><span class="line">    link&#x2F;loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1&#x2F;8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line">    link&#x2F;ether 00:16:3e:10:27:9e brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.16.62.130&#x2F;18 brd 172.16.63.255 scope global eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure>
<h3 id="link">link</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@nenuoj$ ip link show eth0</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP mode DEFAULT group default qlen 1000</span><br><span class="line">    link&#x2F;ether 00:11:22:33:44:55 brd ff:ff:ff:ff:ff:ff</span><br></pre></td></tr></table></figure>
<h3 id="route-1">route</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@nenuoj$ ip route</span><br><span class="line">default via 172.16.63.253 dev eth0</span><br><span class="line">172.16.0.0&#x2F;18 dev eth0  proto kernel  scope link  src 172.16.62.130</span><br></pre></td></tr></table></figure>
<hr />
<h2 id="netstat">netstat</h2>
<p>https://linux.die.net/man/8/netstat</p>
<blockquote>
<p>netstat - Print network connections, routing tables, interface statistics, masquerade connections, and multicast memberships</p>
</blockquote>
<h3 id="list-all-tcp-listening-ports">List all tcp listening ports</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@nenuoj$ netstat -tl</span><br><span class="line">Active Internet connections (only servers)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State</span><br><span class="line">tcp        0      0 localhost:32000         *:*                     LISTEN</span><br><span class="line">tcp        0      0 *:27015                 *:*                     LISTEN</span><br><span class="line">tcp        0      0 localhost:mysql         *:*                     LISTEN</span><br><span class="line">tcp        0      0 localhost:11211         *:*                     LISTEN</span><br><span class="line">tcp        0      0 localhost:6379          *:*                     LISTEN</span><br><span class="line">tcp        0      0 *:http                  *:*                     LISTEN</span><br><span class="line">tcp        0      0 *:ssh                   *:*                     LISTEN</span><br><span class="line">tcp        0      0 *:https                 *:*                     LISTEN</span><br><span class="line">tcp        0      0 localhost:1087          *:*                     LISTEN</span><br><span class="line">tcp6       0      0 [::]:http               [::]:*                  LISTEN</span><br></pre></td></tr></table></figure>
<h3 id="list-all-tcp-connections-with-pid-and-numericals">List all tcp connections with pid and numericals</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">root@nenuoj$ netstat -atnp</span><br><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID&#x2F;Program name</span><br><span class="line">tcp        0      0 127.0.0.1:32000         0.0.0.0:*               LISTEN      972&#x2F;java</span><br><span class="line">tcp        0      0 0.0.0.0:27015           0.0.0.0:*               LISTEN      1323&#x2F;Judger</span><br><span class="line">tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      1203&#x2F;mysqld</span><br><span class="line">tcp        0      0 127.0.0.1:11211         0.0.0.0:*               LISTEN      1278&#x2F;memcached</span><br><span class="line">tcp        0      0 127.0.0.1:6379          0.0.0.0:*               LISTEN      808&#x2F;redis-server 12</span><br><span class="line">tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      1270&#x2F;nginx -g daemo</span><br><span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1044&#x2F;sshd</span><br><span class="line">tcp        0      0 0.0.0.0:443             0.0.0.0:*               LISTEN      1270&#x2F;nginx -g daemo</span><br><span class="line">tcp        0      0 127.0.0.1:1087          0.0.0.0:*               LISTEN      430&#x2F;privoxy</span><br><span class="line">tcp        0      0 172.16.62.130:38632     100.100.30.25:80        ESTABLISHED 1403&#x2F;AliYunDun</span><br><span class="line">tcp        0      0 172.16.62.130:80        182.122.161.236:52680   FIN_WAIT2   -</span><br><span class="line">tcp        0      0 172.16.62.130:80        182.122.161.236:52669   FIN_WAIT2   -</span><br><span class="line">tcp        0      0 172.16.62.130:80        182.122.161.236:52686   FIN_WAIT2   -</span><br><span class="line">tcp        0      0 127.0.0.1:32000         127.0.0.1:31000         ESTABLISHED 933&#x2F;wrapper</span><br><span class="line">tcp        0      0 172.16.62.130:80        182.122.161.236:52681   FIN_WAIT2   -</span><br><span class="line">tcp        0      0 172.16.62.130:80        182.122.161.236:52679   FIN_WAIT2   -</span><br><span class="line">tcp        0      0 127.0.0.1:31000         127.0.0.1:32000         ESTABLISHED 972&#x2F;java</span><br><span class="line">tcp        0    560 172.16.62.130:22        120.52.147.54:49840     ESTABLISHED 4232&#x2F;1</span><br><span class="line">tcp        0      0 172.16.62.130:80        182.122.161.236:52682   FIN_WAIT2   -</span><br><span class="line">tcp        0      0 172.16.62.130:80        182.122.161.236:52668   FIN_WAIT2   -</span><br><span class="line">tcp6       0      0 :::80                   :::*                    LISTEN      1270&#x2F;nginx -g daemo</span><br></pre></td></tr></table></figure>
<h3 id="display-routing">Display routing</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@nenuoj$ netstat -r</span><br><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface</span><br><span class="line">default         172.16.63.253   0.0.0.0         UG        0 0          0 eth0</span><br><span class="line">172.16.0.0      *               255.255.192.0   U         0 0          0 eth0</span><br></pre></td></tr></table></figure>
<h3 id="show-interface-infomation">Show interface infomation</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@nenuoj$ netstat -i</span><br><span class="line">Kernel Interface table</span><br><span class="line">Iface   MTU Met   RX-OK RX-ERR RX-DRP RX-OVR    TX-OK TX-ERR TX-DRP TX-OVR Flg</span><br><span class="line">eth0       1500 0     40465      0      0 0         33318      0      0      0 BMRU</span><br><span class="line">lo        65536 0     10406      0      0 0         10406      0      0      0 LRU</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/23/IP-checksum/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/23/IP-checksum/" class="post-title-link" itemprop="url">IP checksum</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-23 14:22:00 14:22:00" itemprop="dateCreated datePublished" datetime="2020-04-23T14:22:00+08:00">2020-04-23 14:22:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/23/IP-checksum/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/23/IP-checksum/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>To do an experiment, first capture an IP packet, as we can see the checksum is 0xCAD7. Then we set the checksum field to 0, and calculate the checksum, then we will get 0xCAD7. Set 0xCAD7 to the checksum field and calculate the checksum again, we will get 0 then. <img src="/images/posts/IP-checksum/0.png" /></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DBG(x) cerr &lt;&lt; #x &lt;&lt; <span class="meta-string">&quot; = &quot;</span> &lt;&lt; x &lt;&lt; endl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="title">ip_checksum</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">unsigned</span> <span class="keyword">short</span>&gt; &amp;v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; v.size(); i++) &#123;</span><br><span class="line">        sum += v[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (sum &gt; <span class="number">0xFFFF</span>) &#123;</span><br><span class="line">        sum = (sum &amp; <span class="number">0xFFFF</span>) + (sum &gt;&gt; <span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ~sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">unsigned</span> <span class="keyword">short</span>&gt; vec&#123;<span class="number">0x4500</span>, <span class="number">0x0235</span>, <span class="number">0x0000</span>, <span class="number">0x4000</span>, <span class="number">0x4006</span>, <span class="number">0x0000</span>, <span class="number">0x0a01</span>, <span class="number">0xbf44</span>, <span class="number">0x8ba2</span>, <span class="number">0x1904</span>&#125;;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">short</span> sum = ip_checksum(vec);</span><br><span class="line">    assert(sum == <span class="number">0xcad7</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;checksum = 0x%X\n&quot;</span>, sum);</span><br><span class="line"></span><br><span class="line">    vec[<span class="number">5</span>] = sum;</span><br><span class="line"></span><br><span class="line">    sum = ip_checksum(vec);</span><br><span class="line">    assert(sum == <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%X\n&quot;</span>, sum);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ToRapture"
      src="/uploads/avatar.jpg">
  <p class="site-author-name" itemprop="name">ToRapture</p>
  <div class="site-description" itemprop="description">Some notes</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">78</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/ToRapture" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ToRapture" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/ToRapture" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;ToRapture" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:torapture@gmail.com" title="E-Mail → mailto:torapture@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ToRapture</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://torapture.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>

</body>
</html>
