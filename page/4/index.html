<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/uploads/favicon32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/uploads/favicon16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"torapture.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Some notes">
<meta property="og:type" content="website">
<meta property="og:title" content="ToRapture&#39;s Blog">
<meta property="og:url" content="https://torapture.github.io/page/4/index.html">
<meta property="og:site_name" content="ToRapture&#39;s Blog">
<meta property="og:description" content="Some notes">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="ToRapture">
<meta property="article:tag" content="ToRapture, Linux">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://torapture.github.io/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>ToRapture's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ToRapture's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">A Programmer</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/17/Learn-Goroutine/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/17/Learn-Goroutine/" class="post-title-link" itemprop="url">Learn Goroutine</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-17 15:48:00 15:48:00" itemprop="dateCreated datePublished" datetime="2020-04-17T15:48:00+08:00">2020-04-17 15:48:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/17/Learn-Goroutine/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/17/Learn-Goroutine/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="definitions">Definitions</h2>
<p>https://morsmachine.dk/go-scheduler</p>
<p>An OS thread, which is the thread of execution managed by the OS and works pretty much like your standard POSIX thread. In the runtime code, it's called M for machine.</p>
<p>A goroutine, which includes the stack, the instruction pointer and other information important for scheduling goroutines, like any channel it might be blocked on. In the runtime code, it's called a G.</p>
<p>A context for scheduling, which you can look at as a localized version of the scheduler which runs Go code on a single thread. It's the important part that lets us go from a N:1 scheduler to a M:N scheduler. In the runtime code, it's called P for processor.</p>
<h2 id="codes">Codes</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;math/rand&quot;</span></span><br><span class="line">    <span class="string">&quot;net/http&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">    <span class="string">&quot;sync&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line">    logger <span class="string">&quot;github.com/sirupsen/logrus&quot;</span></span><br><span class="line">    <span class="string">&quot;github.com/x-cray/logrus-prefixed-formatter&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">    logger.SetFormatter(&amp;prefixed.TextFormatter&#123;</span><br><span class="line">        TimestampFormat: <span class="string">&quot;2006-01-02 15:04:05&quot;</span>,</span><br><span class="line">        FullTimestamp:   <span class="literal">true</span>,</span><br><span class="line">        ForceFormatting: <span class="literal">true</span>,</span><br><span class="line">        DisableColors:   <span class="literal">true</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    logger.SetOutput(os.Stdout)</span><br><span class="line">    logger.SetLevel(logger.DebugLevel)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">calculate</span><span class="params">()</span></span> &#123;</span><br><span class="line">    x := rand.Int()</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">1000000</span>; i++ &#123;</span><br><span class="line">        x ^= rand.Int()</span><br><span class="line">        x |= rand.Int()</span><br><span class="line">        x &amp;= rand.Int()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">cpuIntenseTask</span><span class="params">()</span></span> &#123;</span><br><span class="line">    logger.Infof(<span class="string">&quot;[cpuIntenseTask] started&quot;</span>)</span><br><span class="line"></span><br><span class="line">    wg := sync.WaitGroup&#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">16</span>; i++ &#123;</span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">            wg.Add(<span class="number">1</span>)</span><br><span class="line">            calculate()</span><br><span class="line">            wg.Done()</span><br><span class="line">        &#125;()</span><br><span class="line">    &#125;</span><br><span class="line">    wg.Wait()</span><br><span class="line"></span><br><span class="line">    logger.Infof(<span class="string">&quot;[cpuIntenseTask] finished&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sleepTask</span><span class="params">()</span></span> &#123;</span><br><span class="line">    logger.Infof(<span class="string">&quot;[sleepTask] started&quot;</span>)</span><br><span class="line"></span><br><span class="line">    wg := sync.WaitGroup&#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">64</span>; i++ &#123;</span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">            wg.Add(<span class="number">1</span>)</span><br><span class="line">            time.Sleep(<span class="number">1500</span> * time.Millisecond)</span><br><span class="line">            wg.Done()</span><br><span class="line">        &#125;()</span><br><span class="line">    &#125;</span><br><span class="line">    wg.Wait()</span><br><span class="line"></span><br><span class="line">    logger.Infof(<span class="string">&quot;[sleepTask] finished&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">httpGet</span><span class="params">()</span></span> &#123;</span><br><span class="line">    resp, err := http.Get(<span class="string">&quot;https://google.com&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;httpGet error: %v\n&quot;</span>, err)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    logger.Infof(<span class="string">&quot;httpGet status: %v&quot;</span>, resp.StatusCode)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">netTask</span><span class="params">()</span></span> &#123;</span><br><span class="line">    logger.Infof(<span class="string">&quot;[netTask] started&quot;</span>)</span><br><span class="line"></span><br><span class="line">    wg := sync.WaitGroup&#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">31200</span>; i++ &#123;</span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">            wg.Add(<span class="number">1</span>)</span><br><span class="line">            httpGet()</span><br><span class="line">            wg.Done()</span><br><span class="line">        &#125;()</span><br><span class="line">    &#125;</span><br><span class="line">    wg.Wait()</span><br><span class="line"></span><br><span class="line">    logger.Infof(<span class="string">&quot;[netTask] finished&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    cpuIntenseTask()</span><br><span class="line">    sleepTask()</span><br><span class="line">    netTask()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line">$ go build</span><br><span class="line">$ GODEBUG&#x3D;schedtrace&#x3D;1000 .&#x2F;go-learn 1&gt;learn.out 2&gt;&amp;1</span><br><span class="line">$ cat learn.out | grep -v &quot;error&quot;</span><br><span class="line">SCHED 0ms: gomaxprocs&#x3D;4 idleprocs&#x3D;2 threads&#x3D;4 spinningthreads&#x3D;1 idlethreads&#x3D;0 runqueue&#x3D;0 [1 0 0 0]</span><br><span class="line">[2020-04-17 15:40:53]  INFO cpuIntenseTask: started</span><br><span class="line">[2020-04-17 15:40:53]  INFO cpuIntenseTask: finished</span><br><span class="line">[2020-04-17 15:40:53]  INFO sleepTask: started</span><br><span class="line">[2020-04-17 15:40:53]  INFO sleepTask: finished</span><br><span class="line">[2020-04-17 15:40:53]  INFO netTask: started</span><br><span class="line">SCHED 100ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;10 spinningthreads&#x3D;0 idlethreads&#x3D;1 runqueue&#x3D;19587 [128 25 0 0]</span><br><span class="line">SCHED 204ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;10 spinningthreads&#x3D;0 idlethreads&#x3D;1 runqueue&#x3D;23291 [30 74 33 1]</span><br><span class="line">SCHED 313ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;10 spinningthreads&#x3D;0 idlethreads&#x3D;1 runqueue&#x3D;14978 [77 41 108 125]</span><br><span class="line">SCHED 421ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;11 spinningthreads&#x3D;0 idlethreads&#x3D;0 runqueue&#x3D;6388 [97 74 34 109]</span><br><span class="line">SCHED 529ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;12 spinningthreads&#x3D;0 idlethreads&#x3D;1 runqueue&#x3D;0 [3 6 2 1]</span><br><span class="line">SCHED 638ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;12 spinningthreads&#x3D;0 idlethreads&#x3D;1 runqueue&#x3D;4 [3 0 1 9]</span><br><span class="line">SCHED 743ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;3 runqueue&#x3D;0 [1 0 1 4]</span><br><span class="line">SCHED 853ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;0 [2 7 1 2]</span><br><span class="line">SCHED 960ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;160 [0 1 39 11]</span><br><span class="line">SCHED 1070ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;129 [0 1 3 6]</span><br><span class="line">SCHED 1179ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;93 [20 3 24 14]</span><br><span class="line">SCHED 1286ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;1549 [0 1 74 114]</span><br><span class="line">SCHED 1396ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;1597 [0 0 26 88]</span><br><span class="line">SCHED 1503ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;426 [96 1 44 69]</span><br><span class="line"> 112 4]</span><br><span class="line">SCHED 1716ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;41 [9 2 69 6]</span><br><span class="line">SCHED 1821ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;62 [12 0 5 1]</span><br><span class="line">SCHED 1929ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;51 [9 0 6 1]</span><br><span class="line">SCHED 2036ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;45 [15 0 9 1]</span><br><span class="line">SCHED 2139ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;88 [1 10 7 6]</span><br><span class="line">SCHED 2243ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;135 [1 1 13 11]</span><br><span class="line">SCHED 2349ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;51 [1 10 4 5]</span><br><span class="line">SCHED 2456ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;44 [1 7 11 0]</span><br><span class="line">SCHED 2563ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;63 [1 6 10 0]</span><br><span class="line">SCHED 2670ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;3 runqueue&#x3D;95 [1 6 10 0]</span><br><span class="line">SCHED 2770ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;83 [1 7 9 0]</span><br><span class="line">SCHED 2877ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;1 [1 12 155 1]</span><br><span class="line">SCHED 2981ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;105 [11 11 13 1]</span><br><span class="line">SCHED 3087ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;140 [7 11 1 1]</span><br><span class="line">SCHED 3195ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;73 [1 0 8 0]</span><br><span class="line">SCHED 3303ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;138 [46 0 4 1]</span><br><span class="line">SCHED 3413ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;147 [22 0 0 1]</span><br><span class="line">SCHED 3514ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;3 runqueue&#x3D;157 [5 19 51 1]</span><br><span class="line">1957 [5 86 124 1]</span><br><span class="line">SCHED 3728ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;133 [3 38 38 0]</span><br><span class="line">SCHED 3834ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;141 [40 31 14 0]</span><br><span class="line">SCHED 3937ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;37 [1 2 8 2]</span><br><span class="line">SCHED 4041ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;74 [0 1 9 0]</span><br><span class="line">SCHED 4147ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;60 [0 1 14 9]</span><br><span class="line">SCHED 4251ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;71 [0 0 9 41]</span><br><span class="line">SCHED 4357ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;5 [0 1 0 0]</span><br><span class="line">SCHED 4460ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;4 [0 2 0 1]</span><br><span class="line">SCHED 4567ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;202 [21 1 0 11]</span><br><span class="line">SCHED 4677ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;6 runqueue&#x3D;79 [7 1 8 5]</span><br><span class="line">4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;46 [4 1 1 2]</span><br><span class="line">SCHED 4887ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;8 [0 0 0 0]</span><br><span class="line">SCHED 4996ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;18 [0 0 1 3]</span><br><span class="line">SCHED 5102ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;76 [15 0 1 11]</span><br><span class="line">SCHED 5209ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;109 [70 1 1 1]</span><br><span class="line">SCHED 5314ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;87 [12 1 1 4]</span><br><span class="line">SCHED 5419ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;14 [0 0 1 1]</span><br><span class="line">SCHED 5522ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;8 [0 0 1 1]</span><br><span class="line">SCHED 5622ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;3 runqueue&#x3D;90 [140 1 22 0]</span><br><span class="line">SCHED 5725ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;85 [91 1 9 21]</span><br><span class="line">SCHED 5830ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;71 [1 1 21 2]</span><br><span class="line">SCHED 5936ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;8 [1 1 0 0]</span><br><span class="line">SCHED 6038ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;99 [11 2 1 0]</span><br><span class="line">SCHED 6143ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;14 [97 1 4 2]</span><br><span class="line">SCHED 6249ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;55 [1 62 123 33]</span><br><span class="line">SCHED 6355ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;78 [1 6 4 17]</span><br><span class="line">SCHED 6458ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;485 [1 100 101 111]</span><br><span class="line">SCHED 6563ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;101 [1 15 5 13]</span><br><span class="line">SCHED 6667ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;40 [1 2 74 0]</span><br><span class="line">SCHED 6775ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;85 [1 6 8 98]</span><br><span class="line">SCHED 6879ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;71 [1 14 1 1]</span><br><span class="line"> 8 108 0]</span><br><span class="line">SCHED 7088ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;613 [14 102 43 100]</span><br><span class="line">SCHED 7196ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;155 [1 101 7 13]</span><br><span class="line">SCHED 7297ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;95 [1 18 7 100]</span><br><span class="line">SCHED 7402ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;27 [1 2 2 4]</span><br><span class="line">SCHED 7507ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;12 [119 0 0 1]</span><br><span class="line">SCHED 7612ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;44 [2 8 14 1]</span><br><span class="line">SCHED 7720ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;14 [4 1 2 2]</span><br><span class="line">SCHED 7825ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;0 [164 0 1 0]</span><br><span class="line">SCHED 7931ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;3 runqueue&#x3D;36 [4 0 0 1]</span><br><span class="line">SCHED 8041ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;42 [5 2 2 1]</span><br><span class="line">SCHED 8143ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;62 [0 2 7 1]</span><br><span class="line">SCHED 8243ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;2 runqueue&#x3D;132 [1 239 26 23]</span><br><span class="line">SCHED 8346ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;68 [2 4 3 4]</span><br><span class="line">SCHED 8451ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;39 [6 1 1 0]</span><br><span class="line">SCHED 8560ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;151 [146 0 1 9]</span><br><span class="line">SCHED 8665ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;100 [1 8 0 25]</span><br><span class="line">SCHED 8771ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;38 [2 1 1 1]</span><br><span class="line">SCHED 8878ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;0 [1 0 0 115]</span><br><span class="line">SCHED 8987ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;89 [6 17 5 3]</span><br><span class="line">SCHED 9088ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;5 runqueue&#x3D;901 [99 195 80 116]</span><br><span class="line">SCHED 9193ms: gomaxprocs&#x3D;4 idleprocs&#x3D;0 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;4 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 9301ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 9404ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 9508ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 9615ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 9717ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 9817ms: gomaxprocs&#x3D;4 idleprocs&#x3D;2 threads&#x3D;15 spinningthreads&#x3D;1 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 9926ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 10027ms: gomaxprocs&#x3D;4 idleprocs&#x3D;2 threads&#x3D;15 spinningthreads&#x3D;1 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 10139ms: gomaxprocs&#x3D;4 idleprocs&#x3D;2 threads&#x3D;15 spinningthreads&#x3D;1 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 10241ms: gomaxprocs&#x3D;4 idleprocs&#x3D;3 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;8 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 10341ms: gomaxprocs&#x3D;4 idleprocs&#x3D;2 threads&#x3D;15 spinningthreads&#x3D;1 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 10443ms: gomaxprocs&#x3D;4 idleprocs&#x3D;3 threads&#x3D;15 spinningthreads&#x3D;1 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 10547ms: gomaxprocs&#x3D;4 idleprocs&#x3D;2 threads&#x3D;15 spinningthreads&#x3D;1 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 10653ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 10753ms: gomaxprocs&#x3D;4 idleprocs&#x3D;2 threads&#x3D;15 spinningthreads&#x3D;1 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 10865ms: gomaxprocs&#x3D;4 idleprocs&#x3D;3 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;8 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 10975ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;8 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 11087ms: gomaxprocs&#x3D;4 idleprocs&#x3D;3 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;8 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 11189ms: gomaxprocs&#x3D;4 idleprocs&#x3D;2 threads&#x3D;15 spinningthreads&#x3D;1 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 11291ms: gomaxprocs&#x3D;4 idleprocs&#x3D;2 threads&#x3D;15 spinningthreads&#x3D;1 idlethreads&#x3D;7 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 11391ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 11501ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 11604ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 11713ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 11821ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 11930ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 12041ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 12141ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 12247ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 12354ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 12456ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 12558ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 12666ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 12769ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 12878ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 12983ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 13083ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 13186ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 13290ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 13395ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 13504ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 13605ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 13706ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">SCHED 13808ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;15 spinningthreads&#x3D;0 idlethreads&#x3D;9 runqueue&#x3D;0 [0 0 0 0]</span><br><span class="line">[2020-04-17 15:41:07]  INFO netTask: finished</span><br></pre></td></tr></table></figure>
<hr />
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line"></span><br><span class="line">    logger <span class="string">&quot;github.com/sirupsen/logrus&quot;</span></span><br><span class="line">    <span class="string">&quot;github.com/x-cray/logrus-prefixed-formatter&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">    logger.SetFormatter(&amp;prefixed.TextFormatter&#123;</span><br><span class="line">        TimestampFormat: <span class="string">&quot;2006-01-02 15:04:05&quot;</span>,</span><br><span class="line">        FullTimestamp:   <span class="literal">true</span>,</span><br><span class="line">        ForceFormatting: <span class="literal">true</span>,</span><br><span class="line">        DisableColors:   <span class="literal">true</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    logger.SetOutput(os.Stdout)</span><br><span class="line">    logger.SetLevel(logger.DebugLevel)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">var</span> s <span class="keyword">string</span></span><br><span class="line">        fmt.Scanln(&amp;s)</span><br><span class="line">        ch &lt;- s</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    s := &lt;-ch</span><br><span class="line">    logger.Infof(<span class="string">&quot;input is: %v&quot;</span>, s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">$ GODEBUG&#x3D;schedtrace&#x3D;500,scheddetail&#x3D;1 .&#x2F;go-learn 1&gt;learn.out 2&gt;&amp;1</span><br><span class="line">$ cat learn.out</span><br><span class="line">SCHED 0ms: gomaxprocs&#x3D;4 idleprocs&#x3D;2 threads&#x3D;3 spinningthreads&#x3D;1 idlethreads&#x3D;0 runqueue&#x3D;0 gcwaiting&#x3D;0 nmidlelocked&#x3D;0 stopwait&#x3D;0 sysmonwait&#x3D;0</span><br><span class="line">  P0: status&#x3D;1 schedtick&#x3D;0 syscalltick&#x3D;0 m&#x3D;0 runqsize&#x3D;0 gfreecnt&#x3D;0</span><br><span class="line">  P1: status&#x3D;1 schedtick&#x3D;0 syscalltick&#x3D;0 m&#x3D;2 runqsize&#x3D;0 gfreecnt&#x3D;0</span><br><span class="line">  P2: status&#x3D;0 schedtick&#x3D;0 syscalltick&#x3D;0 m&#x3D;-1 runqsize&#x3D;0 gfreecnt&#x3D;0</span><br><span class="line">  P3: status&#x3D;0 schedtick&#x3D;0 syscalltick&#x3D;0 m&#x3D;-1 runqsize&#x3D;0 gfreecnt&#x3D;0</span><br><span class="line">  M2: p&#x3D;1 curg&#x3D;-1 mallocing&#x3D;0 throwing&#x3D;0 preemptoff&#x3D; locks&#x3D;1 dying&#x3D;0 spinning&#x3D;false blocked&#x3D;false lockedg&#x3D;-1</span><br><span class="line">  M1: p&#x3D;-1 curg&#x3D;-1 mallocing&#x3D;0 throwing&#x3D;0 preemptoff&#x3D; locks&#x3D;1 dying&#x3D;0 spinning&#x3D;false blocked&#x3D;false lockedg&#x3D;-1</span><br><span class="line">  M0: p&#x3D;0 curg&#x3D;-1 mallocing&#x3D;0 throwing&#x3D;0 preemptoff&#x3D; locks&#x3D;1 dying&#x3D;0 spinning&#x3D;false blocked&#x3D;false lockedg&#x3D;1</span><br><span class="line">  G1: status&#x3D;1() m&#x3D;-1 lockedm&#x3D;0</span><br><span class="line">  G2: status&#x3D;1() m&#x3D;-1 lockedm&#x3D;-1</span><br><span class="line">SCHED 500ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;5 spinningthreads&#x3D;0 idlethreads&#x3D;3 runqueue&#x3D;0 gcwaiting&#x3D;0 nmidlelocked&#x3D;0 stopwait&#x3D;0 sysmonwait&#x3D;0</span><br><span class="line">  P0: status&#x3D;0 schedtick&#x3D;2 syscalltick&#x3D;0 m&#x3D;-1 runqsize&#x3D;0 gfreecnt&#x3D;0</span><br><span class="line">  P1: status&#x3D;0 schedtick&#x3D;3 syscalltick&#x3D;0 m&#x3D;-1 runqsize&#x3D;0 gfreecnt&#x3D;0</span><br><span class="line">  P2: status&#x3D;0 schedtick&#x3D;2 syscalltick&#x3D;6 m&#x3D;-1 runqsize&#x3D;0 gfreecnt&#x3D;0</span><br><span class="line">  P3: status&#x3D;0 schedtick&#x3D;0 syscalltick&#x3D;0 m&#x3D;-1 runqsize&#x3D;0 gfreecnt&#x3D;0</span><br><span class="line">  M4: p&#x3D;-1 curg&#x3D;-1 mallocing&#x3D;0 throwing&#x3D;0 preemptoff&#x3D; locks&#x3D;0 dying&#x3D;0 spinning&#x3D;false blocked&#x3D;true lockedg&#x3D;-1</span><br><span class="line">  M3: p&#x3D;-1 curg&#x3D;-1 mallocing&#x3D;0 throwing&#x3D;0 preemptoff&#x3D; locks&#x3D;0 dying&#x3D;0 spinning&#x3D;false blocked&#x3D;true lockedg&#x3D;-1</span><br><span class="line">  M2: p&#x3D;-1 curg&#x3D;-1 mallocing&#x3D;0 throwing&#x3D;0 preemptoff&#x3D; locks&#x3D;0 dying&#x3D;0 spinning&#x3D;false blocked&#x3D;true lockedg&#x3D;-1</span><br><span class="line">  M1: p&#x3D;-1 curg&#x3D;-1 mallocing&#x3D;0 throwing&#x3D;0 preemptoff&#x3D; locks&#x3D;1 dying&#x3D;0 spinning&#x3D;false blocked&#x3D;false lockedg&#x3D;-1</span><br><span class="line">  M0: p&#x3D;-1 curg&#x3D;34 mallocing&#x3D;0 throwing&#x3D;0 preemptoff&#x3D; locks&#x3D;0 dying&#x3D;0 spinning&#x3D;false blocked&#x3D;false lockedg&#x3D;-1</span><br><span class="line">  G1: status&#x3D;4(chan receive) m&#x3D;-1 lockedm&#x3D;-1</span><br><span class="line">  G2: status&#x3D;4(force gc (idle)) m&#x3D;-1 lockedm&#x3D;-1</span><br><span class="line">  G17: status&#x3D;4(GC sweep wait) m&#x3D;-1 lockedm&#x3D;-1</span><br><span class="line">  G18: status&#x3D;4(GC scavenge wait) m&#x3D;-1 lockedm&#x3D;-1</span><br><span class="line">  G33: status&#x3D;4(finalizer wait) m&#x3D;-1 lockedm&#x3D;-1</span><br><span class="line">  G34: status&#x3D;3() m&#x3D;0 lockedm&#x3D;-1</span><br><span class="line">SCHED 1010ms: gomaxprocs&#x3D;4 idleprocs&#x3D;4 threads&#x3D;5 spinningthreads&#x3D;0 idlethreads&#x3D;3 runqueue&#x3D;0 gcwaiting&#x3D;0 nmidlelocked&#x3D;0 stopwait&#x3D;0 sysmonwait&#x3D;0</span><br><span class="line">  P0: status&#x3D;0 schedtick&#x3D;2 syscalltick&#x3D;0 m&#x3D;-1 runqsize&#x3D;0 gfreecnt&#x3D;0</span><br><span class="line">  P1: status&#x3D;0 schedtick&#x3D;3 syscalltick&#x3D;0 m&#x3D;-1 runqsize&#x3D;0 gfreecnt&#x3D;0</span><br><span class="line">  P2: status&#x3D;0 schedtick&#x3D;2 syscalltick&#x3D;6 m&#x3D;-1 runqsize&#x3D;0 gfreecnt&#x3D;0</span><br><span class="line">  P3: status&#x3D;0 schedtick&#x3D;0 syscalltick&#x3D;0 m&#x3D;-1 runqsize&#x3D;0 gfreecnt&#x3D;0</span><br><span class="line">  M4: p&#x3D;-1 curg&#x3D;-1 mallocing&#x3D;0 throwing&#x3D;0 preemptoff&#x3D; locks&#x3D;0 dying&#x3D;0 spinning&#x3D;false blocked&#x3D;true lockedg&#x3D;-1</span><br><span class="line">  M3: p&#x3D;-1 curg&#x3D;-1 mallocing&#x3D;0 throwing&#x3D;0 preemptoff&#x3D; locks&#x3D;0 dying&#x3D;0 spinning&#x3D;false blocked&#x3D;true lockedg&#x3D;-1</span><br><span class="line">  M2: p&#x3D;-1 curg&#x3D;-1 mallocing&#x3D;0 throwing&#x3D;0 preemptoff&#x3D; locks&#x3D;0 dying&#x3D;0 spinning&#x3D;false blocked&#x3D;true lockedg&#x3D;-1</span><br><span class="line">  M1: p&#x3D;-1 curg&#x3D;-1 mallocing&#x3D;0 throwing&#x3D;0 preemptoff&#x3D; locks&#x3D;1 dying&#x3D;0 spinning&#x3D;false blocked&#x3D;false lockedg&#x3D;-1</span><br><span class="line">  M0: p&#x3D;-1 curg&#x3D;34 mallocing&#x3D;0 throwing&#x3D;0 preemptoff&#x3D; locks&#x3D;0 dying&#x3D;0 spinning&#x3D;false blocked&#x3D;false lockedg&#x3D;-1</span><br><span class="line">  G1: status&#x3D;4(chan receive) m&#x3D;-1 lockedm&#x3D;-1</span><br><span class="line">  G2: status&#x3D;4(force gc (idle)) m&#x3D;-1 lockedm&#x3D;-1</span><br><span class="line">  G17: status&#x3D;4(GC sweep wait) m&#x3D;-1 lockedm&#x3D;-1</span><br><span class="line">  G18: status&#x3D;4(GC scavenge wait) m&#x3D;-1 lockedm&#x3D;-1</span><br><span class="line">  G33: status&#x3D;4(finalizer wait) m&#x3D;-1 lockedm&#x3D;-1</span><br><span class="line">  G34: status&#x3D;3() m&#x3D;0 lockedm&#x3D;-1</span><br><span class="line">[2020-04-17 15:55:36]  INFO input is: hello</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/16/Redis-eviction-policies/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/16/Redis-eviction-policies/" class="post-title-link" itemprop="url">Redis eviction policies</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-16 13:47:00 13:47:00" itemprop="dateCreated datePublished" datetime="2020-04-16T13:47:00+08:00">2020-04-16 13:47:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/16/Redis-eviction-policies/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/16/Redis-eviction-policies/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="official-document">Official document</h2>
<p><a target="_blank" rel="noopener" href="https://redis.io/topics/lru-cache">Using Redis as an LRU cache</a></p>
<h2 id="eviction-policies">Eviction policies</h2>
<p>There are total 6 evicition policies so far:</p>
<ul>
<li>noeviction</li>
<li>allkeys-lru</li>
<li>allkeys-random</li>
<li>volatile-lru</li>
<li>volatile-random</li>
<li>volatile-ttl</li>
</ul>
<p><code>allkeys</code> for all keys, while <code>volatile</code> means among keys that have an expire set. <code>lru</code> means evict keys by trying to remove the less recently used (LRU) keys first, <code>random</code> means evict keys randomly, <code>ttl</code> means try to evict keys with a shorter time to live (TTL) first.</p>
<hr />
<p>The range of the keys to be evicted: Only the keys that have a expire set are in both the <code>dict</code> and <code>expires</code> two dicts, others are in <code>dict</code> only. <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (server.maxmemory_policy == REDIS_MAXMEMORY_ALLKEYS_LRU ||</span><br><span class="line">    server.maxmemory_policy == REDIS_MAXMEMORY_ALLKEYS_RANDOM)</span><br><span class="line">&#123;</span><br><span class="line">    dict = server.db[j].dict;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    dict = server.db[j].expires;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr />
<p>Getting a paricular key by using random: <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* volatile-random and allkeys-random policy */</span></span><br><span class="line"><span class="keyword">if</span> (server.maxmemory_policy == REDIS_MAXMEMORY_ALLKEYS_RANDOM ||</span><br><span class="line">    server.maxmemory_policy == REDIS_MAXMEMORY_VOLATILE_RANDOM)</span><br><span class="line">&#123;</span><br><span class="line">    de = dictGetRandomKey(dict);</span><br><span class="line">    bestkey = dictGetKey(de);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr />
<p>Getting a particular key by using LRU: <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* volatile-lru and allkeys-lru policy */</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (server.maxmemory_policy == REDIS_MAXMEMORY_ALLKEYS_LRU ||</span><br><span class="line">    server.maxmemory_policy == REDIS_MAXMEMORY_VOLATILE_LRU)</span><br><span class="line">&#123;</span><br><span class="line">    struct evictionPoolEntry *pool = db-&gt;eviction_pool;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(bestkey == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        evictionPoolPopulate(dict, db-&gt;dict, db-&gt;eviction_pool);</span><br><span class="line">        <span class="comment">/* Go backward from best to worst element to evict. */</span></span><br><span class="line">        <span class="keyword">for</span> (k = REDIS_EVICTION_POOL_SIZE<span class="number">-1</span>; k &gt;= <span class="number">0</span>; k--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (pool[k].key == <span class="literal">NULL</span>) <span class="keyword">continue</span>;</span><br><span class="line">            de = dictFind(dict,pool[k].key);</span><br><span class="line"></span><br><span class="line">            <span class="comment">/* Remove the entry from the pool. */</span></span><br><span class="line">            sdsfree(pool[k].key);</span><br><span class="line">            <span class="comment">/* Shift all elements on its right to left. */</span></span><br><span class="line">            memmove(pool+k,pool+k+<span class="number">1</span>,</span><br><span class="line">                <span class="keyword">sizeof</span>(pool[<span class="number">0</span>])*(REDIS_EVICTION_POOL_SIZE-k<span class="number">-1</span>));</span><br><span class="line">            <span class="comment">/* Clear the element on the right which is empty</span></span><br><span class="line"><span class="comment">             * since we shifted one position to the left.  */</span></span><br><span class="line">            pool[REDIS_EVICTION_POOL_SIZE<span class="number">-1</span>].key = <span class="literal">NULL</span>;</span><br><span class="line">            pool[REDIS_EVICTION_POOL_SIZE<span class="number">-1</span>].idle = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/* If the key exists, is our pick. Otherwise it is</span></span><br><span class="line"><span class="comment">             * a ghost and we need to try the next element. */</span></span><br><span class="line">            <span class="keyword">if</span> (de) &#123;</span><br><span class="line">                bestkey = dictGetKey(de);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">/* Ghost... */</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr />
<p>Getting a particular key by using TTL: <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* volatile-ttl */</span></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (server.maxmemory_policy == REDIS_MAXMEMORY_VOLATILE_TTL) &#123;</span><br><span class="line">    <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; server.maxmemory_samples; k++) &#123;</span><br><span class="line">        sds thiskey;</span><br><span class="line">        <span class="keyword">long</span> thisval;</span><br><span class="line">        de = dictGetRandomKey(dict);</span><br><span class="line">        thiskey = dictGetKey(de);</span><br><span class="line">        thisval = (<span class="keyword">long</span>) dictGetVal(de);</span><br><span class="line">        <span class="comment">/* Expire sooner (minor expire unix timestamp) is better</span></span><br><span class="line"><span class="comment">         * candidate for deletion */</span></span><br><span class="line">        <span class="keyword">if</span> (bestkey == <span class="literal">NULL</span> || thisval &lt; bestval) &#123;</span><br><span class="line">            bestkey = thiskey;</span><br><span class="line">            bestval = thisval;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/14/Hungarian-Algorithm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/14/Hungarian-Algorithm/" class="post-title-link" itemprop="url">Hungarian Algorithm</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-14 14:04:00 14:04:00" itemprop="dateCreated datePublished" datetime="2020-04-14T14:04:00+08:00">2020-04-14 14:04:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/14/Hungarian-Algorithm/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/14/Hungarian-Algorithm/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="links">Links</h2>
<p>https://www.renfei.org/blog/bipartite-matching.html https://en.wikipedia.org/wiki/Matching_(graph_theory)</p>
<h2 id="hungarian-algorithm">Hungarian Algorithm</h2>
<p>Given a matching M,</p>
<ul>
<li>an alternating path is a path that begins with an unmatched vertex and whose edges belong alternately to the matching and not to the matching.</li>
<li>an augmenting path is an alternating path that starts from and ends on free (unmatched) vertices.</li>
</ul>
<p>Traverse all the points on the left, for each point <span class="math inline">\(u\)</span> if we can find a augmenting path <span class="math inline">\(\vec{p}\)</span> starting from <span class="math inline">\(u\)</span>, then we use the edges of <span class="math inline">\(\vec{p}\)</span> to update the matches of each point on <span class="math inline">\(\vec{p}\)</span>.</p>
<h2 id="problems">Problems</h2>
<p><a target="_blank" rel="noopener" href="http://acm.hdu.edu.cn/showproblem.php?pid=1068">HDU 1068 Girls and Boys</a></p>
<p>This problem is to figure out the number of maximum independent set of bipartite graph.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DBG(x) cerr &lt;&lt; #x &lt;&lt; <span class="meta-string">&quot; = &quot;</span> &lt;&lt; x &lt;&lt; endl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1024</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[MAXN];</span><br><span class="line"><span class="keyword">int</span> match[MAXN];</span><br><span class="line"><span class="keyword">bool</span> vis[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        g[i].clear();</span><br><span class="line">    &#125;</span><br><span class="line">    fill(match, match + n, <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[v]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[v] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (match[v] == <span class="number">-1</span> || dfs(match[v])) &#123;</span><br><span class="line">            match[v] = u;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hungary</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        fill(vis, vis + n, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (dfs(i)) ans++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) != EOF) &#123;</span><br><span class="line">        init(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> u, cnt;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d: (%d) &quot;</span>, &amp;u, &amp;cnt);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; cnt; j++) &#123;</span><br><span class="line">                <span class="keyword">int</span> v;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v);</span><br><span class="line">                g[u].push_back(v);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, n - hungary(n));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="http://acm.hdu.edu.cn/showproblem.php?pid=1179">HDU 1179 Ollivanders: Makers of Fine Wands since 382 BC.</a></p>
<p>There are 3 ways to solve the problem.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DBG(x) cerr &lt;&lt; #x &lt;&lt; <span class="meta-string">&quot; = &quot;</span> &lt;&lt; x &lt;&lt; endl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">128</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[MAXN];</span><br><span class="line"><span class="keyword">int</span> match[MAXN];</span><br><span class="line"><span class="keyword">bool</span> vis[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        g[i].clear();</span><br><span class="line">    &#125;</span><br><span class="line">    fill(match + <span class="number">1</span>, match + <span class="number">1</span> + n, <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    g[u].push_back(v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[v]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[v] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (match[v] == <span class="number">-1</span> || dfs(match[v])) &#123;</span><br><span class="line">            match[v] = u;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hungary</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        fill(vis + <span class="number">1</span>, vis + <span class="number">1</span> + n, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (dfs(i)) ans++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m) != EOF) &#123;</span><br><span class="line">        init(n, m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> c;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;c);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; c; j++) &#123;</span><br><span class="line">                <span class="keyword">int</span> v;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v);</span><br><span class="line">                add(i, v);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, hungary(n, m));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DBG(x) cerr &lt;&lt; #x &lt;&lt; <span class="meta-string">&quot; = &quot;</span> &lt;&lt; x &lt;&lt; endl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">128</span> * <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[MAXN];</span><br><span class="line"><span class="keyword">int</span> match[MAXN];</span><br><span class="line"><span class="keyword">bool</span> vis[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    g[u].push_back(v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + m; i++) &#123;</span><br><span class="line">        g[i].clear();</span><br><span class="line">    &#125;</span><br><span class="line">    fill(match + <span class="number">1</span>, match + <span class="number">1</span> + n, <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[v]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[v] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (match[v] == <span class="number">-1</span> || dfs(match[v])) &#123;</span><br><span class="line">            match[v] = u;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hungarian</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> u = n + <span class="number">1</span>; u &lt;= n + m; u++) &#123;</span><br><span class="line">        fill(vis + <span class="number">1</span>, vis + <span class="number">1</span> + n, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (dfs(u)) ans++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m) != EOF) &#123;</span><br><span class="line">        init(n, m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> u = n + <span class="number">1</span>; u &lt;= n + m; u++) &#123;</span><br><span class="line">            <span class="keyword">int</span> c;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;c);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; c; j++) &#123;</span><br><span class="line">                <span class="keyword">int</span> v;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v);</span><br><span class="line">                add(u, v);</span><br><span class="line">                add(v, u);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, hungarian(n, m));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DBG(x) cerr &lt;&lt; #x &lt;&lt; <span class="meta-string">&quot; = &quot;</span> &lt;&lt; x &lt;&lt; endl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">128</span> * <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[MAXN];</span><br><span class="line"><span class="keyword">int</span> match[MAXN];</span><br><span class="line"><span class="keyword">bool</span> vis[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + m; i++) &#123;</span><br><span class="line">        g[i].clear();</span><br><span class="line">    &#125;</span><br><span class="line">    fill(match + <span class="number">1</span>, match + <span class="number">1</span> + n + m, <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[v]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[v] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (match[v] == <span class="number">-1</span> || dfs(match[v])) &#123;</span><br><span class="line">            match[v] = u;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hungarian</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> u = <span class="number">1</span>; u &lt;= n + m; u++) &#123;</span><br><span class="line">        fill(vis + <span class="number">1</span>, vis + <span class="number">1</span> + n + m, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">if</span> (dfs(u)) ans++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    g[u].push_back(v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m) != EOF) &#123;</span><br><span class="line">        init(n, m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> u = n + <span class="number">1</span>; u &lt;= n + m; u++) &#123;</span><br><span class="line">            <span class="keyword">int</span> c;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;c);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; c; j++) &#123;</span><br><span class="line">                <span class="keyword">int</span> v;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v);</span><br><span class="line">                add(u, v);</span><br><span class="line">                add(v, u);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, hungarian(n, m));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/13/Prime-and-Factors/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/13/Prime-and-Factors/" class="post-title-link" itemprop="url">Prime and Factors</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-13 14:25:00 14:25:00" itemprop="dateCreated datePublished" datetime="2020-04-13T14:25:00+08:00">2020-04-13 14:25:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/13/Prime-and-Factors/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/13/Prime-and-Factors/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="http://acm.hdu.edu.cn/showproblem.php?pid=1164">HDU 1164</a> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DBG(x) cerr &lt;&lt; #x &lt;&lt; <span class="meta-string">&quot; = &quot;</span> &lt;&lt; x &lt;&lt; endl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">65535</span> + <span class="number">16</span>;</span><br><span class="line"><span class="keyword">bool</span> is_prime[MAXN];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; primes;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Factor</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line">    <span class="keyword">int</span> cnt;</span><br><span class="line"></span><br><span class="line">    Factor() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    Factor(<span class="keyword">int</span> value, <span class="keyword">int</span> cnt) : value(value), cnt(cnt) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init_prime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    fill(is_prime, is_prime + MAXN, <span class="literal">true</span>);</span><br><span class="line">    is_prime[<span class="number">0</span>] = is_prime[<span class="number">1</span>] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!is_prime[i]) <span class="keyword">continue</span>;</span><br><span class="line">        primes.push_back(i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">long</span> <span class="keyword">long</span> j = <span class="number">1L</span>L * i * i; j &lt; MAXN; j += i) &#123;</span><br><span class="line">            is_prime[j] = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;Factor&gt; <span class="title">get_factors</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;Factor&gt; factors;</span><br><span class="line">    <span class="keyword">int</span> temp = x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; primes.size() &amp;&amp; primes[i] &lt;= x / primes[i]; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (temp % primes[i] == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="function">Factor <span class="title">factor</span><span class="params">(primes[i], <span class="number">0</span>)</span></span>;</span><br><span class="line">            <span class="keyword">while</span> (temp % primes[i] == <span class="number">0</span>) &#123;</span><br><span class="line">                factor.cnt++;</span><br><span class="line">                temp /= primes[i];</span><br><span class="line">            &#125;</span><br><span class="line">            factors.push_back(factor);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (temp &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        factors.push_back(Factor(temp, <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> factors;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    init_prime();</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x) != EOF) &#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;Factor&gt; factors = get_factors(x);</span><br><span class="line">        <span class="built_in">string</span> ans;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; factors.size(); i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; factors[i].cnt; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!ans.empty()) ans += <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line">                ans += to_string(factors[i].value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(ans.c_str());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><a target="_blank" rel="noopener" href="http://acm.hdu.edu.cn/showproblem.php?pid=4548">HDU 4548</a> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DBG(x) cerr &lt;&lt; #x &lt;&lt; <span class="meta-string">&quot; = &quot;</span> &lt;&lt; x &lt;&lt; endl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1000000</span> + <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Prime</span> &#123;</span></span><br><span class="line">    <span class="keyword">bool</span> is_prime[MAXN];</span><br><span class="line">    <span class="keyword">int</span> sum[MAXN];</span><br><span class="line"></span><br><span class="line">    Prime() &#123;</span><br><span class="line">        fill(is_prime, is_prime + MAXN, <span class="literal">true</span>);</span><br><span class="line">        fill(sum, sum + MAXN, <span class="number">0</span>);</span><br><span class="line">        is_prime[<span class="number">0</span>] = is_prime[<span class="number">1</span>] = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!is_prime[i]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">long</span> <span class="keyword">long</span> j = <span class="number">1L</span>L * i * i; j &lt; MAXN; j += i) &#123;</span><br><span class="line">                is_prime[j] = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXN; i++) &#123;</span><br><span class="line">            sum[i] = sum[i - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (is_beautiful(i)) sum[i]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">is_beautiful</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!is_prime[x]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">int</span> s = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (x) &#123;</span><br><span class="line">            s += x % <span class="number">10</span>;</span><br><span class="line">            x /= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> is_prime[s];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sum[r] - sum[l - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; p;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line">        <span class="keyword">int</span> l, r;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: %d\n&quot;</span>, cas, p.get(l, r));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/13/Quick-Sort/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/13/Quick-Sort/" class="post-title-link" itemprop="url">Quick Sort</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-13 12:01:00 12:01:00" itemprop="dateCreated datePublished" datetime="2020-04-13T12:01:00+08:00">2020-04-13 12:01:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/13/Quick-Sort/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/13/Quick-Sort/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="implementation">Implementation</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DBG(x) cerr &lt;&lt; #x &lt;&lt; <span class="meta-string">&quot; = &quot;</span> &lt;&lt; x &lt;&lt; endl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qsort</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;vec, <span class="keyword">int</span> s, <span class="keyword">int</span> e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (s &gt;= e) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> pv = vec[s];</span><br><span class="line">    <span class="keyword">int</span> l = s, r = e;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = s + <span class="number">1</span>, left = e - s; left &gt; <span class="number">0</span>; left--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vec[i] &lt; pv) &#123;</span><br><span class="line">            vec[l++] = vec[i++];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            swap(vec[i], vec[r--]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    assert(l == r);</span><br><span class="line">    vec[l] = pv;</span><br><span class="line">    qsort(vec, s, l - <span class="number">1</span>);</span><br><span class="line">    qsort(vec, l + <span class="number">1</span>, e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    srand(time(<span class="literal">NULL</span>));</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">vec</span><span class="params">(<span class="number">500000</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vec.size(); i++) vec[i] = random();</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; s = vec;</span><br><span class="line"></span><br><span class="line">    sort(s.begin(), s.end());</span><br><span class="line">    qsort(vec, <span class="number">0</span>, vec.size() - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    assert(s == vec);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Golang version updated at 2020-04-20 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">type</span> less []<span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l less)</span> <span class="title">Less</span><span class="params">(i, j <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> l[i] &lt; l[j]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l less)</span> <span class="title">Swap</span><span class="params">(i, j <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    l[i], l[j] = l[j], l[i]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l less)</span> <span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">len</span>(l)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">quickSort</span><span class="params">(data less, s, e <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> s &gt;= e &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    data.Swap(s, rand.Int()%(e-s+<span class="number">1</span>)+s)</span><br><span class="line"></span><br><span class="line">    l, r := s, e</span><br><span class="line">    <span class="keyword">for</span> i, left := s+<span class="number">1</span>, e-s; left &gt; <span class="number">0</span>; left-- &#123;</span><br><span class="line">        <span class="keyword">if</span> data.Less(i, l) &#123;</span><br><span class="line">            data.Swap(i, l)</span><br><span class="line">            i++</span><br><span class="line">            l++</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            data.Swap(i, r)</span><br><span class="line">            r--</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    quickSort(data, s, l<span class="number">-1</span>)</span><br><span class="line">    quickSort(data, l+<span class="number">1</span>, e)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sortArray</span><span class="params">(nums []<span class="keyword">int</span>)</span> []<span class="title">int</span></span> &#123;</span><br><span class="line">    rand.Seed(time.Now().Unix())</span><br><span class="line">    data := less(nums)</span><br><span class="line">    quickSort(data, <span class="number">0</span>, data.Len()<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">return</span> nums</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="proof">Proof</h2>
<h3 id="correctness-of-partition">Correctness of partition</h3>
<p><span class="math inline">\(s\)</span> is the first index in the subarray of <span class="math inline">\(vec\)</span>, <span class="math inline">\(e\)</span> is the last index in the subarray of <span class="math inline">\(vec\)</span>. <span class="math inline">\(vec[s:e]\)</span> denotes the whole subarray, inclusive. At the start of the <strong>for</strong> loop:</p>
<ul>
<li><span class="math inline">\(i\)</span> denotes the index of the element to be compared with the pivot</li>
<li><span class="math inline">\(left\)</span> denotes the number of remaining elements to be compared</li>
<li><span class="math inline">\(l\)</span> denotes the minimum position to put the element which is smaller than the pivot</li>
<li><span class="math inline">\(r\)</span> denotes the maximum position to put the element which is greater than or equal to the pivot</li>
</ul>
<p>We say there are <span class="math inline">\(x\)</span> elements <span class="math inline">\(&lt;\)</span> pivot, then there are supposed to be <span class="math inline">\(e - s - x\)</span> elements <span class="math inline">\(&gt;=\)</span> pivot. After the <strong>for</strong> loop terminates, <span class="math inline">\(l\)</span> will be <span class="math inline">\(s + x\)</span>, and <span class="math inline">\(y\)</span> will be <span class="math inline">\(e - (e - s - x) = s + x\)</span> too, so <span class="math inline">\(l = r\)</span>. The elements on the left side of <span class="math inline">\(l \ or\  r\)</span> are all <span class="math inline">\(&lt;\)</span> pivot, and the elements of the right side of <span class="math inline">\(l \ or \ r\)</span> are all <span class="math inline">\(&gt;=\)</span> pivot, then we put the pivot on the position <span class="math inline">\(l \ or \ r\)</span>. Then all the elements on the left side of the pivot will be smaller than the pivot, and all the elements on the right side of the pivot will be greater than or equal to the pivot. Thus, the partition is correct.</p>
<h3 id="correctness-of-recursion">Correctness of recursion</h3>
<p>Proof by induction. Suppose that <span class="math inline">\(P(n)\)</span> is a predicate defined on <span class="math inline">\(n \in [1, \infty)\)</span> meaning the <span class="math inline">\(Quick Sort\)</span> is correct on a given array sized <span class="math inline">\(n\)</span>. If we can show that: 1. <span class="math inline">\(P(1)\)</span> is true 2. (<span class="math inline">\(\forall k &lt; n \ P(k)) \implies P(n)\)</span></p>
<p>Then <span class="math inline">\(P(n)\)</span> is true for all integers <span class="math inline">\(n &gt;= 1\)</span>. <span class="math inline">\(P(1)\)</span> is obviously true.</p>
<blockquote>
<p>To use quicksort to sort an array of size 𝑛, we partition it into three pieces: the first 𝑘 subarray, the pivot (which will be in its correct place), and the remaining subarray of size 𝑛−𝑘−1. By the way partition works, every element in the first subarray will be less than or equal to the pivot and every element in the other subarray will be greater than or equal to the pivot, so when we recursively sort the first and last subarrays, we will wind up having sorted the entire array.</p>
</blockquote>
<blockquote>
<p>We show this is correct by strong induction: since the first subarray has 𝑘&lt;𝑛 elements, we can assume by induction that it will be correctly sorted. Since the second subarray has 𝑛−𝑘−1&lt;𝑛 elements, we can assume that it will be correctly sorted. Thus, putting all the pieces together, we will wind up having sorted the array.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</blockquote>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>https://cs.stackexchange.com/a/63667<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/12/HDU-2642-Stars/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/12/HDU-2642-Stars/" class="post-title-link" itemprop="url">HDU 2642 Stars</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-12 18:50:00 18:50:00" itemprop="dateCreated datePublished" datetime="2020-04-12T18:50:00+08:00">2020-04-12 18:50:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/12/HDU-2642-Stars/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/12/HDU-2642-Stars/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="http://acm.hdu.edu.cn/showproblem.php?pid=2642">Stars</a></p>
<p>Two dimensional binary indexed tree.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DBG(x) cerr &lt;&lt; #x &lt;&lt; <span class="meta-string">&quot; = &quot;</span> &lt;&lt; x &lt;&lt; endl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1002</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Bit</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> c[N][N];</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        <span class="keyword">this</span>-&gt;m = m;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; j++) &#123;</span><br><span class="line">                c[i][j] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = x; i &lt;= n; i += lowbit(i)) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = y; j &lt;= m; j += lowbit(j)) &#123;</span><br><span class="line">                c[i][j] += v;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> s = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = x; i &gt; <span class="number">0</span>; i -= lowbit(i)) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = y; j &gt; <span class="number">0</span>; j -= lowbit(j)) &#123;</span><br><span class="line">                s += c[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; bit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> star[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) != EOF) &#123;</span><br><span class="line">        <span class="keyword">int</span> m = <span class="number">1001</span>;</span><br><span class="line">        bit.init(m, m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">                star[i][j] = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">char</span> op[<span class="number">2</span>];</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, op);</span><br><span class="line">            <span class="keyword">if</span> (op[<span class="number">0</span>] == <span class="string">&#x27;B&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">int</span> x, y;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">                x++, y++;</span><br><span class="line">                <span class="keyword">if</span> (!star[x][y]) &#123;</span><br><span class="line">                    star[x][y] = <span class="literal">true</span>;</span><br><span class="line">                    bit.add(x, y, <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op[<span class="number">0</span>] == <span class="string">&#x27;D&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">int</span> x, y;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">                x++, y++;</span><br><span class="line">                <span class="keyword">if</span> (star[x][y]) &#123;</span><br><span class="line">                    star[x][y] = <span class="literal">false</span>;</span><br><span class="line">                    bit.add(x, y, <span class="number">-1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> x1, x2, y1, y2;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;x1, &amp;x2, &amp;y1, &amp;y2);</span><br><span class="line">                <span class="keyword">if</span> (x1 &gt; x2) &#123;</span><br><span class="line">                    swap(x1, x2);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (y1 &gt; y2) &#123;</span><br><span class="line">                    swap(y1, y2);</span><br><span class="line">                &#125;</span><br><span class="line">                x1++, x2++, y1++, y2++;</span><br><span class="line">                <span class="keyword">int</span> res = bit.get(x2, y2) - bit.get(x1 - <span class="number">1</span>, y2) - bit.get(x2, y1 - <span class="number">1</span>) + bit.get(x1 - <span class="number">1</span>, y1 - <span class="number">1</span>);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, res);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/10/236-Lowest-Common-Ancestor-of-a-Binary-Tree/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/10/236-Lowest-Common-Ancestor-of-a-Binary-Tree/" class="post-title-link" itemprop="url">236. Lowest Common Ancestor of a Binary Tree</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-10 16:51:00 16:51:00" itemprop="dateCreated datePublished" datetime="2020-04-10T16:51:00+08:00">2020-04-10 16:51:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/10/236-Lowest-Common-Ancestor-of-a-Binary-Tree/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/10/236-Lowest-Common-Ancestor-of-a-Binary-Tree/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/lowest-common-ancestor-of-a-binary-tree/">236. Lowest Common Ancestor of a Binary Tree</a></p>
<p>If we can find two subtrees of root such that both of them has target, then root is the LCA of p and q. If there is exactly one subtree of root having target and root itself has target, then root is the LCA of p and q too.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     TreeNode *right;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) : val(x), left(NULL), right(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    TreeNode *ans;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">hasTarget</span><span class="params">(TreeNode *root, TreeNode *p, TreeNode *q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">nullptr</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">bool</span> left = hasTarget(root-&gt;left, p, q);</span><br><span class="line">        <span class="keyword">bool</span> right = hasTarget(root-&gt;right, p, q);</span><br><span class="line">        <span class="keyword">bool</span> mid = root == p || root == q;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ((left &amp;&amp; right) || (left &amp;&amp; mid) || (mid &amp;&amp; right)) &#123;</span><br><span class="line">            ans = root;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> left || right || mid;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function">TreeNode* <span class="title">lowestCommonAncestor</span><span class="params">(TreeNode* root, TreeNode* p, TreeNode* q)</span> </span>&#123;</span><br><span class="line">        ans = <span class="literal">nullptr</span>;</span><br><span class="line">        hasTarget(root, p, q);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/07/Leetcode-96-Unique-Binary-Search-Trees/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/07/Leetcode-96-Unique-Binary-Search-Trees/" class="post-title-link" itemprop="url">Leetcode 96. Unique Binary Search Trees</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-07 20:02:00 20:02:00" itemprop="dateCreated datePublished" datetime="2020-04-07T20:02:00+08:00">2020-04-07 20:02:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/07/Leetcode-96-Unique-Binary-Search-Trees/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/07/Leetcode-96-Unique-Binary-Search-Trees/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/unique-binary-search-trees/">Unique Binary Search Trees</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numTrees</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// We consider the position of node n in the tree first.</span></span><br><span class="line">        <span class="comment">// Because all nodes on the tree except for node n is less than node,</span></span><br><span class="line">        <span class="comment">// if node n has children, that must be its left child.</span></span><br><span class="line">        <span class="comment">// Node n can have a parent if the value of its parent is less than its.</span></span><br><span class="line">        <span class="comment">// So we separate the n - 1 nodes into 2 parts, the first part is considered to be the parent part of node n,</span></span><br><span class="line">        <span class="comment">// and the second part is considered to be the left child part of node n.</span></span><br><span class="line">        <span class="comment">// We traverse every possible separation, for each separation we add the multiplication of the number of the combination</span></span><br><span class="line">        <span class="comment">// of the two parts to the answer of node n.</span></span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++) &#123;</span><br><span class="line">                dp[i] += dp[j] * dp[i - <span class="number">1</span> - j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/04/Search-in-Rotated-Sorted-Array/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/04/Search-in-Rotated-Sorted-Array/" class="post-title-link" itemprop="url">Search in Rotated Sorted Array</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-04 11:05:00 11:05:00" itemprop="dateCreated datePublished" datetime="2020-04-04T11:05:00+08:00">2020-04-04 11:05:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/04/Search-in-Rotated-Sorted-Array/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/04/Search-in-Rotated-Sorted-Array/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/search-in-rotated-sorted-array/">33. Search in Rotated Sorted Array</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, r = nums.size() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">            <span class="keyword">int</span> mid = (l + r) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (nums[mid] == target) <span class="keyword">return</span> mid;</span><br><span class="line">            <span class="keyword">if</span> (nums[mid] &lt; target) &#123;</span><br><span class="line">                <span class="comment">// target on the left side and mid on the right side</span></span><br><span class="line">                <span class="keyword">if</span> (target &gt; nums[r] &amp;&amp; nums[mid] &lt; nums[l]) r = mid - <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// target on the right side and mid on the left side</span></span><br><span class="line">                <span class="keyword">if</span> (target &lt; nums[l] &amp;&amp; nums[mid] &gt; nums[r]) l = mid + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://torapture.github.io/2020/04/01/ID-Generator/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="ToRapture">
      <meta itemprop="description" content="Some notes">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ToRapture's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/01/ID-Generator/" class="post-title-link" itemprop="url">ID Generator</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-04-01 16:52:00 16:52:00" itemprop="dateCreated datePublished" datetime="2020-04-01T16:52:00+08:00">2020-04-01 16:52:00</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 22:07:40 22:07:40" itemprop="dateModified" datetime="2020-10-11T22:07:40+08:00">2020-10-11 22:07:40</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/04/01/ID-Generator/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/01/ID-Generator/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="implementation">Implementation</h2>
<p>Some details of this implementation borrow from <a target="_blank" rel="noopener" href="https://github.com/sony/sonyflake">sonyflake</a>. Here using 8 bits to represent time in units of 500ms, 4 bits to represent sequence, 4 bits to represent machine. As a result:</p>
<ul>
<li>The lifetime is <span class="math inline">\(2^8 \times 500ms = 128s\)</span></li>
<li>It can work in <span class="math inline">\(2^4 = 16\)</span> distributed machines</li>
<li>It can generate <span class="math inline">\(2^4 = 16\)</span> IDs per <span class="math inline">\(500ms\)</span> at most in a single thread</li>
</ul>
<h3 id="code">Code</h3>
<p><code>server</code>: <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;errors&quot;</span></span><br><span class="line">    <span class="string">&quot;net/http&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">    <span class="string">&quot;sync&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">    logger <span class="string">&quot;github.com/sirupsen/logrus&quot;</span></span><br><span class="line">    <span class="string">&quot;github.com/x-cray/logrus-prefixed-formatter&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">    logger.SetFormatter(&amp;prefixed.TextFormatter&#123;</span><br><span class="line">        TimestampFormat: <span class="string">&quot;2006-01-02 15:04:05&quot;</span>,</span><br><span class="line">        FullTimestamp:   <span class="literal">true</span>,</span><br><span class="line">        ForceFormatting: <span class="literal">true</span>,</span><br><span class="line">        DisableColors:   <span class="literal">true</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    logger.SetOutput(os.Stdout)</span><br><span class="line">    logger.SetLevel(logger.DebugLevel)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">    BitLenTick      = <span class="number">8</span></span><br><span class="line">    BitLenSequence  = <span class="number">4</span></span><br><span class="line">    BitLenMachineID = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    tickTimeUnit = time.Millisecond * <span class="number">500</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> idFlake *IDFlake</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> IDFlake <span class="keyword">struct</span> &#123;</span><br><span class="line">    mu sync.Mutex</span><br><span class="line"></span><br><span class="line">    machineID   <span class="keyword">int64</span></span><br><span class="line">    startTick   <span class="keyword">int64</span> <span class="comment">// ticks of the start time of IDFlake from UNIX epoch</span></span><br><span class="line">    elapsedTick <span class="keyword">int64</span> <span class="comment">// elapsed ticks from start tick</span></span><br><span class="line">    sequence    <span class="keyword">int64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">toFlakeTime</span><span class="params">(t time.Time)</span> <span class="title">int64</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> t.UTC().UnixNano() / <span class="keyword">int64</span>(tickTimeUnit)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewIDFlake</span><span class="params">(machineID <span class="keyword">int64</span>, startTime time.Time)</span> *<span class="title">IDFlake</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;IDFlake&#123;</span><br><span class="line">        machineID:   machineID,</span><br><span class="line">        startTick:   toFlakeTime(startTime),</span><br><span class="line">        elapsedTick: <span class="number">0</span>,</span><br><span class="line">        sequence:    <span class="number">0</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *IDFlake)</span> <span class="title">toID</span><span class="params">()</span> <span class="params">(<span class="keyword">uint64</span>, error)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> f.elapsedTick &gt;= <span class="number">1</span>&lt;&lt;BitLenTick &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, errors.New(<span class="string">&quot;over the time limit&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">uint64</span>(f.elapsedTick&lt;&lt;(BitLenMachineID+BitLenSequence)) | <span class="keyword">uint64</span>(f.machineID&lt;&lt;BitLenSequence) | <span class="keyword">uint64</span>(f.sequence), <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *IDFlake)</span> <span class="title">getID</span><span class="params">()</span> <span class="params">(<span class="keyword">uint64</span>, error)</span></span> &#123;</span><br><span class="line">    f.mu.Lock()</span><br><span class="line">    <span class="keyword">defer</span> f.mu.Unlock()</span><br><span class="line"></span><br><span class="line">    currentTick := toFlakeTime(time.Now()) - f.startTick</span><br><span class="line">    <span class="keyword">if</span> f.elapsedTick &lt; currentTick &#123;</span><br><span class="line">        f.sequence = <span class="number">0</span></span><br><span class="line">        f.elapsedTick = currentTick</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        f.sequence = (f.sequence + <span class="number">1</span>) &amp; (<span class="number">1</span>&lt;&lt;BitLenSequence - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> f.sequence == <span class="number">0</span> &#123;</span><br><span class="line">            f.elapsedTick++</span><br><span class="line">            sleepFor := sleepTime(f.elapsedTick - currentTick)</span><br><span class="line">            time.Sleep(sleepFor)</span><br><span class="line">            logger.Infof(<span class="string">&quot;slept for %.8fms&quot;</span>, sleepFor.Seconds()*<span class="number">1000</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> f.toID()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sleepTime</span><span class="params">(overTick <span class="keyword">int64</span>)</span> <span class="title">time</span>.<span class="title">Duration</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> time.Duration(overTick)*tickTimeUnit - time.Duration(time.Now().UTC().UnixNano())%tickTimeUnit</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Decompose</span><span class="params">(id <span class="keyword">uint64</span>)</span> <span class="title">map</span>[<span class="title">string</span>]<span class="title">uint64</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">uint64</span>&#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>:       id,</span><br><span class="line">        <span class="string">&quot;tick&quot;</span>:     id &gt;&gt; (BitLenMachineID + BitLenSequence),</span><br><span class="line">        <span class="string">&quot;machine&quot;</span>:  (id &gt;&gt; BitLenSequence) &amp; (<span class="number">1</span>&lt;&lt;BitLenMachineID - <span class="number">1</span>),</span><br><span class="line">        <span class="string">&quot;sequence&quot;</span>: id &amp; (<span class="number">1</span>&lt;&lt;BitLenSequence - <span class="number">1</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getID</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    id, err := idFlake.getID()</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        logger.Warnf(<span class="string">&quot;getID error: %v&quot;</span>, err)</span><br><span class="line">        c.JSON(http.StatusOK,</span><br><span class="line">            <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">                <span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">            &#125;,</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    result := Decompose(id)</span><br><span class="line">    c.JSON(http.StatusOK, result)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">httpRun</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line">    r.GET(<span class="string">&quot;/get_id&quot;</span>, getID)</span><br><span class="line">    r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    idFlake = NewIDFlake(<span class="number">8</span>, time.Now())</span><br><span class="line">    httpRun()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>client</code>: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        res = requests.get(<span class="string">&#x27;http://127.0.0.1:8080/get_id&#x27;</span>).json()</span><br><span class="line">        <span class="keyword">print</span> res</span><br><span class="line">        <span class="keyword">if</span> res.get(<span class="string">&#x27;error&#x27;</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p>
<h3 id="run">Run</h3>
<p><code>server</code>: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.</span><br><span class="line"></span><br><span class="line">[GIN-debug] [WARNING] Running in &quot;debug&quot; mode. Switch to &quot;release&quot; mode in production.</span><br><span class="line"> - using env:	export GIN_MODE&#x3D;release</span><br><span class="line"> - using code:	gin.SetMode(gin.ReleaseMode)</span><br><span class="line"></span><br><span class="line">[GIN-debug] Listening and serving HTTP on :8080</span><br><span class="line">[2020-04-01 16:11:05]  INFO slept for 285.71300000ms</span><br><span class="line">[2020-04-01 16:11:06]  INFO slept for 446.46500000ms</span><br><span class="line">[2020-04-01 16:11:06]  INFO slept for 450.56500000ms</span><br><span class="line">[2020-04-01 16:11:07]  INFO slept for 449.93100000ms</span><br><span class="line">......</span><br><span class="line">[2020-04-01 16:13:08]  INFO slept for 449.52100000ms</span><br><span class="line">[2020-04-01 16:13:09]  INFO slept for 441.43400000ms</span><br><span class="line">[2020-04-01 16:13:09]  INFO slept for 434.80600000ms</span><br><span class="line">[2020-04-01 16:13:10]  INFO slept for 445.62500000ms</span><br><span class="line">[2020-04-01 16:13:10]  INFO slept for 444.83400000ms</span><br><span class="line">[2020-04-01 16:13:11]  INFO slept for 437.82700000ms</span><br><span class="line">[2020-04-01 16:13:11]  WARN getID error: over the time limit</span><br></pre></td></tr></table></figure></p>
<p><code>client</code>: <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1024, u&#39;sequence&#39;: 0&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1025, u&#39;sequence&#39;: 1&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1026, u&#39;sequence&#39;: 2&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1027, u&#39;sequence&#39;: 3&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1028, u&#39;sequence&#39;: 4&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1029, u&#39;sequence&#39;: 5&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1030, u&#39;sequence&#39;: 6&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1031, u&#39;sequence&#39;: 7&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1032, u&#39;sequence&#39;: 8&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1033, u&#39;sequence&#39;: 9&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1034, u&#39;sequence&#39;: 10&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1035, u&#39;sequence&#39;: 11&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1036, u&#39;sequence&#39;: 12&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1037, u&#39;sequence&#39;: 13&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1038, u&#39;sequence&#39;: 14&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 4, u&#39;id&#39;: 1039, u&#39;sequence&#39;: 15&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 5, u&#39;id&#39;: 1280, u&#39;sequence&#39;: 0&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 5, u&#39;id&#39;: 1281, u&#39;sequence&#39;: 1&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 5, u&#39;id&#39;: 1282, u&#39;sequence&#39;: 2&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 5, u&#39;id&#39;: 1283, u&#39;sequence&#39;: 3&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 5, u&#39;id&#39;: 1284, u&#39;sequence&#39;: 4&#125;</span><br><span class="line">......</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 254, u&#39;id&#39;: 65037, u&#39;sequence&#39;: 13&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 254, u&#39;id&#39;: 65038, u&#39;sequence&#39;: 14&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 254, u&#39;id&#39;: 65039, u&#39;sequence&#39;: 15&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65280, u&#39;sequence&#39;: 0&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65281, u&#39;sequence&#39;: 1&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65282, u&#39;sequence&#39;: 2&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65283, u&#39;sequence&#39;: 3&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65284, u&#39;sequence&#39;: 4&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65285, u&#39;sequence&#39;: 5&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65286, u&#39;sequence&#39;: 6&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65287, u&#39;sequence&#39;: 7&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65288, u&#39;sequence&#39;: 8&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65289, u&#39;sequence&#39;: 9&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65290, u&#39;sequence&#39;: 10&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65291, u&#39;sequence&#39;: 11&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65292, u&#39;sequence&#39;: 12&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65293, u&#39;sequence&#39;: 13&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65294, u&#39;sequence&#39;: 14&#125;</span><br><span class="line">&#123;u&#39;machine&#39;: 0, u&#39;tick&#39;: 255, u&#39;id&#39;: 65295, u&#39;sequence&#39;: 15&#125;</span><br><span class="line">&#123;u&#39;error&#39;: u&#39;over the time limit&#39;&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ToRapture"
      src="/uploads/avatar.jpg">
  <p class="site-author-name" itemprop="name">ToRapture</p>
  <div class="site-description" itemprop="description">Some notes</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">78</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/ToRapture" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ToRapture" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/ToRapture" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;ToRapture" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:torapture@gmail.com" title="E-Mail → mailto:torapture@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ToRapture</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://torapture.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>

</body>
</html>
